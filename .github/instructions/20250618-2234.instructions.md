# 📋 Copilot RAG 시스템 구현 지침서 요약

## 🎯 프로젝트 목표

Freshdesk 기반 고객지원 상담사를 위한 AI 지원 시스템 구축

- 유사 티켓 추천
- 자동 요약 생성
- 피드백 기반 추천 개선

## 🏗️ 시스템 아키텍처

### 📊 데이터 흐름

```
데이터 수집 → 병합 → LLM 요약 → 임베딩 → Vector DB → 추천 → 피드백
```

### 🗄️ 데이터베이스 구성 (MVP: 각 1개씩)

1. **벡터 DB** (Qdrant Cloud) - 임베딩 검색
2. **애플리케이션 DB** (PostgreSQL) - 구조화 데이터
3. **비밀 저장소** (Secrets Manager) - API 키 관리

## 📁 데이터 처리 전략

### MVP 단계 (현재)

- **파일 기반** JSON 저장
- **로컬 개발** 중심
- **단순한 구조** 유지

### 프로덕션 단계

- **PostgreSQL** 도입
- **AWS RDS** 사용
- **멀티테넌트** 지원

## 🔧 핵심 구현 사항

### 1. 데이터 수집

- 티켓 + 대화 + 첨부파일 **하나로 병합**
- 해시값으로 **중복 감지**
- **청크 단위** 처리

### 2. LLM 요약

- 이슈/해결 방법 **구조화 요약**
- **비용 최적화** (필터링)
- **병렬 처리** 지원

### 3. 벡터 검색

- **요약 텍스트만** 임베딩
- 원본은 **메타데이터로만** 저장
- **company_id 기반** 격리

## 🎨 추상화 레이어 설계

### 장점

- **저장소 변경 용이** (파일 → DB)
- **비즈니스 로직 불변**
- **테스트 편의성**

### 구현 방식

```
인터페이스 정의 → 파일 구현 → PostgreSQL 구현 → 환경변수로 전환
```

## 🚀 멀티플랫폼 확장 전략

### MVP 우선

- **Freshdesk만** 집중
- **기반 구조**는 확장 고려
- **Adapter 패턴** 준비

### 향후 확장

- Zendesk 등 **다른 플랫폼**
- **공통 데이터 모델**
- **플랫폼별 Adapter**

## 📈 추천 개선 방식

### 피드백 수집

- 추천 묶음 단위 **👍/👎**
- **날짜/시간** 기록
- **API로 저장**

### 개선 전략

1. **점수 재조정** (가중치)
2. **임베딩 모델** 교체
3. **LLM reranking** 적용

## 🔐 멀티테넌트 보안

### 고객별 설정

- **DB에 저장** (암호화)
- **동적 로드**
- **캐싱 적용**

### 데이터 격리

- **company_id** 필터링
- **Row-level** 보안
- **API 키** 검증

## 📋 단계별 로드맵

### Phase 1: MVP (2-4주)

- 파일 기반 구현
- 핵심 기능 완성
- 단일 고객 테스트

### Phase 2: 스테이징 (1-2주)

- 클라우드 DB 도입
- 멀티테넌트 검증
- 성능 최적화

### Phase 3: 프로덕션 (2-3주)

- 전체 마이그레이션
- 모니터링 구축
- 자동화 완성

## ✅ 핵심 원칙

1. **MVP 우선** - 복잡도 최소화
2. **점진적 개선** - 단계별 확장
3. **추상화 적용** - 변경 용이성
4. **보안 중시** - 데이터 격리
5. **비용 효율** - 리소스 최적화
