<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: globals.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: globals.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Global state management module for Freshdesk Custom App - Prompt Canvas
 * @description ì „ì—­ ìƒíƒœ ê´€ë¦¬ ëª¨ë“ˆ (Globals)
 * 
 * Freshdesk Custom App - Prompt Canvas
 * ì´ íŒŒì¼ì€ ëª¨ë“  ëª¨ë“ˆì—ì„œ ê³µìœ ë˜ëŠ” ì „ì—­ ë³€ìˆ˜ì™€ ìƒíƒœë¥¼ ì¤‘ì•™ì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤.
 * 
 * ì£¼ìš” ê¸°ëŠ¥:
 * - ì „ì—­ ìƒíƒœ ì•ˆì „ ê´€ë¦¬ (GlobalState ê°ì²´)
 * - í‹°ì¼“ ë°ì´í„° ìºì‹œ ê´€ë¦¬ ë° ë¬´íš¨í™”
 * - FDK í´ë¼ì´ì–¸íŠ¸ ìƒëª…ì£¼ê¸° ê´€ë¦¬
 * - ë¡œë”© ìƒíƒœ ë° ì—ëŸ¬ ìƒíƒœ ì¶”ì 
 * - ëª¨ë“ˆ ê°„ ì˜ì¡´ì„± ê´€ë¦¬ (ModuleDependencyManager)
 * - íƒ€ìž… ê²€ì¦ ë° ë°ì´í„° ë¬´ê²°ì„± ë³´ìž¥
 * 
 * ì‚¬ìš© íŒ¨í„´:
 * - ëª¨ë“  ì „ì—­ ë³€ìˆ˜ëŠ” GlobalState ê°ì²´ë¥¼ í†µí•´ ì ‘ê·¼
 * - ì§ì ‘ ì „ì—­ ë³€ìˆ˜ ì„ ì–¸ ë° ì ‘ê·¼ ê¸ˆì§€
 * - ëª¨ë“ˆ ë“±ë¡ì„ í†µí•œ ì˜ì¡´ì„± ê´€ë¦¬
 * 
 * @author AI Assistant Frontend Team
 * @version 3.3.0
 * @since 1.0.0
 * @namespace GlobalState
 * @author Freshdesk Custom App Team
 * @since 1.0.0
 */

// === ì „ì—­ ê°ì²´ ë° ë³€ìˆ˜ ì •ì˜ ===

/**
 * FDK í´ë¼ì´ì–¸íŠ¸ ê°ì²´ (ì•± ì´ˆê¸°í™” í›„ ì„¤ì •ë¨)
 * Freshdesk í”Œëž«í¼ê³¼ì˜ í†µì‹ ì„ ë‹´ë‹¹í•˜ëŠ” í•µì‹¬ ê°ì²´
 * @type {Object|null}
 */
let client = null;

/**
 * ì•± ì´ˆê¸°í™” ìƒíƒœ í”Œëž˜ê·¸
 * @type {boolean}
 */
let isInitialized = false;

/**
 * ì „ì—­ í‹°ì¼“ ë°ì´í„° ìºì‹œ
 * ë°±ì—”ë“œ API ì‘ë‹µ ë°ì´í„°ë¥¼ ì €ìž¥í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.
 * @type {Object}
 */
let globalTicketData = {
  summary: null,                  // í‹°ì¼“ ìš”ì•½ ì •ë³´
  similar_tickets: [],           // ìœ ì‚¬ í‹°ì¼“ ëª©ë¡
  recommended_solutions: [],     // ì¶”ì²œ ì†”ë£¨ì…˜ ëª©ë¡ (kb_documentsì™€ ë§¤í•‘)
  cached_ticket_id: null,       // ìºì‹œëœ í‹°ì¼“ ID
  ticket_info: null,            // ë°±ì—”ë“œì—ì„œ ë°›ì€ ì™„ì „í•œ í‹°ì¼“ ì •ë³´
  isLoading: false,             // ë¡œë”© ìƒíƒœ í”Œëž˜ê·¸
  lastLoadTime: null,           // ë§ˆì§€ë§‰ ë¡œë“œ ì‹œê°„
};

// === ì „ì—­ ë³€ìˆ˜ ì ‘ê·¼ìž í•¨ìˆ˜ë“¤ ===

/**
 * Set the FDK client object
 * FDK í´ë¼ì´ì–¸íŠ¸ ê°ì²´ ì„¤ì •
 * @param {Object} newClient - FDK client object / FDK í´ë¼ì´ì–¸íŠ¸ ê°ì²´
 * @memberof GlobalState
 */
function setClient(newClient) {
  if (!newClient) {
    console.warn('âš ï¸ ìœ íš¨í•˜ì§€ ì•Šì€ í´ë¼ì´ì–¸íŠ¸ ê°ì²´ìž…ë‹ˆë‹¤.');
    return;
  }
  client = newClient;
  console.log('âœ… FDK í´ë¼ì´ì–¸íŠ¸ ì„¤ì • ì™„ë£Œ');
}

/**
 * Get the FDK client object
 * FDK í´ë¼ì´ì–¸íŠ¸ ê°ì²´ ë°˜í™˜
 * @returns {Object|null} FDK client object or null if not initialized / FDK í´ë¼ì´ì–¸íŠ¸ ê°ì²´ ë˜ëŠ” ì´ˆê¸°í™”ë˜ì§€ ì•Šì€ ê²½ìš° null
 * @memberof GlobalState
 */
function getClient() {
  if (!client) {
    console.warn('âš ï¸ FDK í´ë¼ì´ì–¸íŠ¸ê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
  }
  return client;
}

/**
 * ì•± ì´ˆê¸°í™” ìƒíƒœ ì„¤ì •
 * @param {boolean} state - ì´ˆê¸°í™” ìƒíƒœ
 */
function setInitialized(state) {
  isInitialized = Boolean(state);
  console.log(`ðŸ”„ ì•± ì´ˆê¸°í™” ìƒíƒœ: ${isInitialized ? 'ì™„ë£Œ' : 'ëŒ€ê¸°ì¤‘'}`);
}

/**
 * ì•± ì´ˆê¸°í™” ìƒíƒœ í™•ì¸
 * @returns {boolean} ì´ˆê¸°í™” ì™„ë£Œ ì—¬ë¶€
 */
function getInitialized() {
  return isInitialized;
}

/**
 * ì „ì—­ í‹°ì¼“ ë°ì´í„° ì—…ë°ì´íŠ¸
 * 
 * íŠ¹ì • ë°ì´í„° íƒ€ìž…ì„ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜ ì „ì²´ ë°ì´í„°ë¥¼ ë³‘í•© ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
 * ì—…ë°ì´íŠ¸ ì‹œê°„ì„ ìžë™ìœ¼ë¡œ ê¸°ë¡í•˜ì—¬ ìºì‹œ ë§Œë£Œ í™•ì¸ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
 * 
 * @param {Object} newData - ì—…ë°ì´íŠ¸í•  ë°ì´í„°
 * @param {string} dataType - ë°ì´í„° íƒ€ìž… ('summary', 'similar_tickets', 'recommended_solutions' ë“±)
 * 
 * @example
 * updateGlobalTicketData(ticketSummary, 'summary');
 * updateGlobalTicketData({ summary: data, similar_tickets: tickets });
 */
function updateGlobalTicketData(newData, dataType = null) {
  if (!newData) {
    console.warn('âš ï¸ ì—…ë°ì´íŠ¸í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }

  if (dataType &amp;&amp; dataType in globalTicketData) {
    // íŠ¹ì • ë°ì´í„° íƒ€ìž…ë§Œ ì—…ë°ì´íŠ¸
    globalTicketData[dataType] = newData;
    console.log(`ðŸ“Š ì „ì—­ ë°ì´í„° ì—…ë°ì´íŠ¸: ${dataType}`);
  } else if (typeof newData === 'object' &amp;&amp; !dataType) {
    // ì „ì²´ ë°ì´í„° ê°ì²´ ë³‘í•© ì—…ë°ì´íŠ¸
    globalTicketData = { ...globalTicketData, ...newData };
    console.log('ðŸ“Š ì „ì—­ ë°ì´í„° ì „ì²´ ì—…ë°ì´íŠ¸ ì™„ë£Œ');
  } else {
    console.warn('âš ï¸ ìœ íš¨í•˜ì§€ ì•Šì€ ë°ì´í„° íƒ€ìž… ë˜ëŠ” í˜•ì‹ìž…ë‹ˆë‹¤.');
    return;
  }

  // ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ ê¸°ë¡
  globalTicketData.lastLoadTime = new Date().toISOString();
}

/**
 * ì „ì—­ í‹°ì¼“ ë°ì´í„° ì¡°íšŒ
 * 
 * íŠ¹ì • ë°ì´í„° íƒ€ìž…ì„ ì¡°íšŒí•˜ê±°ë‚˜ ì „ì²´ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
 * 
 * @param {string|null} dataType - ì¡°íšŒí•  ë°ì´í„° íƒ€ìž… (nullì´ë©´ ì „ì²´ ë°˜í™˜)
 * @returns {any} ìš”ì²­ëœ ë°ì´í„°
 * 
 * @example
 * const summary = getGlobalTicketData('summary');
 * const allData = getGlobalTicketData();
 */
function getGlobalTicketData(dataType = null) {
  if (dataType &amp;&amp; dataType in globalTicketData) {
    return globalTicketData[dataType];
  }
  return globalTicketData;
}

/**
 * ì „ì—­ í‹°ì¼“ ë°ì´í„° ìºì‹œ ì´ˆê¸°í™”
 * 
 * ìƒˆë¡œìš´ í‹°ì¼“ìœ¼ë¡œ ì „í™˜í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ì™„ì „ížˆ ë¦¬ì…‹í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
 * ëª¨ë“  ìºì‹œ ë°ì´í„°ë¥¼ ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒë¦¬ê³  ìƒˆë¡œìš´ í‹°ì¼“ IDë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
 * 
 * @param {string|null} ticketId - ìƒˆë¡œìš´ í‹°ì¼“ ID (ì„ íƒì‚¬í•­)
 * 
 * @example
 * resetGlobalTicketCache('TICKET-123');
 * resetGlobalTicketCache(); // ì „ì²´ ì´ˆê¸°í™”
 */
function resetGlobalTicketCache(ticketId = null) {
  console.log('ðŸ”„ ì „ì—­ í‹°ì¼“ ìºì‹œ ì´ˆê¸°í™” ì‹œìž‘');
  
  globalTicketData = {
    summary: null,
    similar_tickets: [],
    recommended_solutions: [],
    cached_ticket_id: ticketId,
    ticket_info: null,
    isLoading: false,
    lastLoadTime: null,
  };
  
  console.log('âœ… ì „ì—­ í‹°ì¼“ ìºì‹œ ì´ˆê¸°í™” ì™„ë£Œ');
}

/**
 * ìºì‹œëœ ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì‚¬
 * @param {number} maxAgeMinutes - ìµœëŒ€ ìºì‹œ ìœ ì§€ ì‹œê°„ (ë¶„)
 * @returns {boolean} ìºì‹œ ë°ì´í„° ìœ íš¨ì„± ì—¬ë¶€
 */
function isGlobalDataValid(maxAgeMinutes = 30) {
  if (!globalTicketData.lastLoadTime) {
    return false;
  }

  const lastLoad = new Date(globalTicketData.lastLoadTime);
  const now = new Date();
  const diffMinutes = (now - lastLoad) / (1000 * 60);

  return diffMinutes &lt; maxAgeMinutes;
}

/**
 * ë¡œë”© ìƒíƒœ ê´€ë¦¬
 * @param {boolean} state - ë¡œë”© ìƒíƒœ
 */
function setGlobalLoading(state) {
  globalTicketData.isLoading = Boolean(state);
  console.log(`ðŸ”„ ì „ì—­ ë¡œë”© ìƒíƒœ: ${globalTicketData.isLoading ? 'ON' : 'OFF'}`);
}

/**
 * ë¡œë”© ìƒíƒœ í™•ì¸
 * @returns {boolean} í˜„ìž¬ ë¡œë”© ìƒíƒœ
 */
function getGlobalLoading() {
  return globalTicketData.isLoading;
}

// === ë””ë²„ê¹… ë° ê°œë°œ ì§€ì› í•¨ìˆ˜ ===

/**
 * ì „ì—­ ìƒíƒœ ë””ë²„ê¹… ì •ë³´ ì¶œë ¥
 */
function debugGlobalState() {
  console.group('ðŸ” ì „ì—­ ìƒíƒœ ë””ë²„ê¹… ì •ë³´');
  console.log('ðŸ“± FDK í´ë¼ì´ì–¸íŠ¸:', client ? 'ì„¤ì •ë¨' : 'ë¯¸ì„¤ì •');
  console.log('ðŸ”„ ì´ˆê¸°í™” ìƒíƒœ:', isInitialized);
  console.log('ðŸ“Š í‹°ì¼“ ë°ì´í„° ìºì‹œ:', globalTicketData);
  console.log('â° ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:', globalTicketData.lastLoadTime);
  console.log('ðŸ”„ ë¡œë”© ìƒíƒœ:', globalTicketData.isLoading);
  console.groupEnd();
}

/**
 * ì „ì—­ ìƒíƒœ ê²€ì¦
 * @returns {Object} ê²€ì¦ ê²°ê³¼
 */
function validateGlobalState() {
  const validation = {
    hasClient: !!client,
    isInitialized: isInitialized,
    hasTicketData: !!globalTicketData.cached_ticket_id,
    isDataFresh: isGlobalDataValid(),
    isLoading: globalTicketData.isLoading,
  };

  validation.isHealthy = validation.hasClient &amp;&amp; validation.isInitialized &amp;&amp; !validation.isLoading;

  return validation;
}

// === ì™¸ë¶€ ì ‘ê·¼ ì¸í„°íŽ˜ì´ìŠ¤ ì •ì˜ ===

/**
 * Global state management object (GlobalState)
 * ì „ì—­ ìƒíƒœ ê´€ë¦¬ ê°ì²´ (GlobalState)
 * 
 * A unified interface for safe access to global state from other modules.
 * All global variables and state should be accessed only through this object.
 * 
 * ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì•ˆì „í•˜ê²Œ ì „ì—­ ìƒíƒœì— ì ‘ê·¼í•  ìˆ˜ ìžˆëŠ” í†µí•© ì¸í„°íŽ˜ì´ìŠ¤ìž…ë‹ˆë‹¤.
 * ëª¨ë“  ì „ì—­ ë³€ìˆ˜ì™€ ìƒíƒœëŠ” ì´ ê°ì²´ë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤.
 * 
 * Features:
 * ì œê³µ ê¸°ëŠ¥:
 * - FDK client lifecycle management / FDK í´ë¼ì´ì–¸íŠ¸ ìƒëª…ì£¼ê¸° ê´€ë¦¬
 * - App initialization state tracking / ì•± ì´ˆê¸°í™” ìƒíƒœ ì¶”ì 
 * - Ticket data cache management / í‹°ì¼“ ë°ì´í„° ìºì‹œ ê´€ë¦¬
 * - Loading state management / ë¡œë”© ìƒíƒœ ê´€ë¦¬
 * - Data validation / ë°ì´í„° ìœ íš¨ì„± ê²€ì¦
 * 
 * @example
 * // Client setup / í´ë¼ì´ì–¸íŠ¸ ì„¤ì •
 * GlobalState.setClient(app.client);
 * 
 * // Data update / ë°ì´í„° ì—…ë°ì´íŠ¸
 * GlobalState.updateGlobalTicketData(newData, 'summary');
 * 
 * // State query / ìƒíƒœ ì¡°íšŒ
 * const isReady = GlobalState.getInitialized();
 * 
 * @namespace GlobalState
 * @global
 */
window.GlobalState = {
  // í´ë¼ì´ì–¸íŠ¸ ê´€ë¦¬
  setClient,
  getClient,
  
  // ì´ˆê¸°í™” ìƒíƒœ ê´€ë¦¬
  setInitialized,
  getInitialized,
  
  // í‹°ì¼“ ë°ì´í„° ê´€ë¦¬
  updateGlobalTicketData,
  getGlobalTicketData,
  resetGlobalTicketCache,
  isGlobalDataValid,
  
  // ë¡œë”© ìƒíƒœ ê´€ë¦¬
  setGlobalLoading,
  getGlobalLoading,
  
  // ë””ë²„ê¹… ë° ê²€ì¦
  debugGlobalState,
  validateGlobalState,
};

// ê°œë°œ í™˜ê²½ì—ì„œëŠ” ì „ì—­ ë³€ìˆ˜ë„ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
if (window.location.hostname === 'localhost' || window.location.hostname.includes('10001')) {
  window.GlobalDebug = {
    client,
    isInitialized,
    globalTicketData,
  };
  
  console.log('ðŸ› ï¸ ê°œë°œ ëª¨ë“œ: GlobalDebug ê°ì²´ê°€ windowì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
}

console.log('âœ… globals.js ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ - ì „ì—­ ìƒíƒœ ê´€ë¦¬ ì¤€ë¹„ë¨');

// ê¸€ë¡œë²Œ ì—ëŸ¬ ì²˜ë¦¬ ì‹œìŠ¤í…œ ê°œì„ 
window.GlobalState.ErrorHandler = {
  // ì—ëŸ¬ ë¡œê·¸ ì €ìž¥ì†Œ
  errorLog: [],
  maxLogSize: 50,

  /**
   * í†µí•© ì—ëŸ¬ ì²˜ë¦¬ í•¨ìˆ˜
   * 
   * ëª¨ë“  ëª¨ë“ˆì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë¥¼ ì¼ê´€ëœ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
   * ì—ëŸ¬ ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ê³ , ì‚¬ìš©ìž ì¹œí™”ì  ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ë©°, ê°œë°œìž ë””ë²„ê¹… ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
   * 
   * @param {Error|string} error - ì—ëŸ¬ ê°ì²´ ë˜ëŠ” ë©”ì‹œì§€
   * @param {Object} context - ì—ëŸ¬ ë°œìƒ ì»¨í…ìŠ¤íŠ¸ ì •ë³´
   * @param {string} context.module - ì—ëŸ¬ê°€ ë°œìƒí•œ ëª¨ë“ˆëª…
   * @param {string} context.function - ì—ëŸ¬ê°€ ë°œìƒí•œ í•¨ìˆ˜ëª…
   * @param {string} context.context - ìƒì„¸ ì»¨í…ìŠ¤íŠ¸ ì •ë³´
   * @param {string} context.userMessage - ì‚¬ìš©ìžì—ê²Œ í‘œì‹œí•  ë©”ì‹œì§€ (ì„ íƒì‚¬í•­)
   * @returns {Object} ì—ëŸ¬ ì •ë³´ ê°ì²´
   */
  handleError(error, context = {}) {
    const errorInfo = {
      id: `error-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
      timestamp: new Date().toISOString(),
      message: error.message || error,
      stack: error.stack,
      context: {
        module: context.module || 'unknown',
        function: context.function || 'unknown',
        details: context.context || '',
        ...context
      },
      url: window.location.href,
      userAgent: navigator.userAgent,
      appState: this.getAppStateSnapshot()
    };

    // ì—ëŸ¬ ë¡œê·¸ì— ì¶”ê°€ (ìµœì‹  ìˆœ)
    this.errorLog.unshift(errorInfo);
    if (this.errorLog.length > this.maxLogSize) {
      this.errorLog = this.errorLog.slice(0, this.maxLogSize);
    }

    // ì½˜ì†”ì— êµ¬ì¡°í™”ëœ ì—ëŸ¬ ì¶œë ¥
    console.group(`ðŸš¨ [${context.module?.toUpperCase() || 'ERROR'}] ${errorInfo.message}`);
    console.error('ðŸ“ ìœ„ì¹˜:', context.function || 'unknown function');
    console.error('ðŸ” ìƒì„¸:', context.details || 'no details');
    console.error('ï¿½ ì•± ìƒíƒœ:', errorInfo.appState);
    if (error.stack) {
      console.error('ðŸ“š ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤:', error.stack);
    }
    console.groupEnd();

    // ì‚¬ìš©ìžì—ê²Œ ì¹œí™”ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
    const userMessage = context.userMessage || this.getUserFriendlyMessage(error, context);
    this.showUserError(userMessage, context.severity || 'error');

    // ì‹¬ê°í•œ ì—ëŸ¬ì˜ ê²½ìš° ì¶”ê°€ ì²˜ë¦¬
    if (context.severity === 'critical') {
      this.handleCriticalError(errorInfo);
    }

    return errorInfo;
  },

  /**
   * ì•± ìƒíƒœ ìŠ¤ëƒ…ìƒ· ìƒì„±
   * ì—ëŸ¬ ë°œìƒ ì‹œì ì˜ ì•± ìƒíƒœë¥¼ ê¸°ë¡í•˜ì—¬ ë””ë²„ê¹…ì— í™œìš©
   */
  getAppStateSnapshot() {
    try {
      const globalData = GlobalState.getGlobalTicketData();
      return {
        isInitialized: GlobalState.getInitialized(),
        hasClient: !!GlobalState.getClient(),
        cachedTicketId: globalData.cached_ticket_id,
        hasTicketData: !!globalData.ticket_info,
        hasSummary: !!globalData.summary,
        isLoading: globalData.isLoading,
        lastLoadTime: globalData.lastLoadTime,
        modulesLoaded: Array.from(ModuleDependencyManager.loadedModules)
      };
    } catch (err) {
      return { error: 'ìƒíƒœ ìŠ¤ëƒ…ìƒ· ìƒì„± ì‹¤íŒ¨', message: err.message };
    }
  },

  /**
   * ì‚¬ìš©ìž ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€ ë³€í™˜
   * 
   * ê¸°ìˆ ì ì¸ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì‚¬ìš©ìžê°€ ì´í•´í•˜ê¸° ì‰¬ìš´ ë©”ì‹œì§€ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
   * ì»¨í…ìŠ¤íŠ¸ì— ë”°ë¼ ì ì ˆí•œ í•´ê²° ë°©ë²•ì„ ì œì‹œí•©ë‹ˆë‹¤.
   * 
   * @param {Error|string} error - ì›ë³¸ ì—ëŸ¬ ê°ì²´ ë˜ëŠ” ë©”ì‹œì§€
   * @param {Object} context - ì—ëŸ¬ ë°œìƒ ì»¨í…ìŠ¤íŠ¸ ì •ë³´
   * @returns {string} ì‚¬ìš©ìž ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
   * 
   * @example
   * const message = ErrorHandler.getUserFriendlyMessage(error, { type: 'api' });
   */
  getUserFriendlyMessage(error, context) {
    const errorMessage = error.message || error;
    
    // ëª¨ë“ˆ ê´€ë ¨ ì—ëŸ¬
    if (errorMessage.includes('undefined') &amp;&amp; context.module) {
      return `${context.module} ëª¨ë“ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.`;
    }
    
    // API ê´€ë ¨ ì—ëŸ¬
    if (context.type === 'api') {
      return 'ì„œë²„ì™€ì˜ ì—°ê²°ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.';
    }
    
    // FDK ê´€ë ¨ ì—ëŸ¬
    if (errorMessage.includes('EventAPI') || context.type === 'fdk') {
      return 'Freshdesk ì—°ê²°ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.';
    }
    
    // ê¸°ë³¸ ì—ëŸ¬ ë©”ì‹œì§€
    return 'ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë¬¸ì œê°€ ê³„ì†ë˜ë©´ ê´€ë¦¬ìžì—ê²Œ ë¬¸ì˜í•´ ì£¼ì„¸ìš”.';
  },

  /**
   * ì‹¬ê°í•œ ì—ëŸ¬ ì²˜ë¦¬
   * 
   * ì•±ì˜ ê¸°ë³¸ ê¸°ëŠ¥ì— ì˜í–¥ì„ ì£¼ëŠ” ì‹¬ê°í•œ ì—ëŸ¬ì— ëŒ€í•œ íŠ¹ë³„ ì²˜ë¦¬
   * 
   * @param {Object} errorInfo - ì—ëŸ¬ ì •ë³´ ê°ì²´
   */
  handleCriticalError(errorInfo) {
    console.error('ðŸ’¥ ì‹¬ê°í•œ ì—ëŸ¬ ë°œìƒ:', errorInfo);
    
    // ì—ëŸ¬ ë³µêµ¬ ì‹œë„ (ì˜ˆ: ì•± ìž¬ì´ˆê¸°í™”)
    try {
      // ì „ì—­ ìƒíƒœ ì´ˆê¸°í™”
      GlobalState.resetGlobalTicketCache();
      
      // ì‚¬ìš©ìžì—ê²Œ ë³µêµ¬ ì•ˆë‚´
      this.showUserError(
        'ì‹¬ê°í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì•±ì„ ë‹¤ì‹œ ì‹œìž‘í•©ë‹ˆë‹¤. ë¬¸ì œê°€ ê³„ì†ë˜ë©´ íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.',
        'critical'
      );
      
      // ì¼ì • ì‹œê°„ í›„ ì•± ìž¬ì‹œìž‘ ì‹œë„
      setTimeout(() => {
        if (typeof window.initializeApp === 'function') {
          window.initializeApp();
        }
      }, 2000);
      
    } catch (recoveryError) {
      console.error('ðŸ’€ ì—ëŸ¬ ë³µêµ¬ ì‹¤íŒ¨:', recoveryError);
      this.showUserError(
        'ë³µêµ¬í•  ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. íŽ˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ ì£¼ì„¸ìš”.',
        'critical'
      );
    }
  },

  /**
   * ê°œì„ ëœ ì‚¬ìš©ìž ì—ëŸ¬ í‘œì‹œ
   * 
   * ì—ëŸ¬ ì‹¬ê°ë„ì— ë”°ë¼ ë‹¤ë¥¸ UI ìŠ¤íƒ€ì¼ê³¼ ì§€ì† ì‹œê°„ì„ ì ìš©í•©ë‹ˆë‹¤.
   * 
   * @param {string} message - í‘œì‹œí•  ë©”ì‹œì§€
   * @param {string} severity - ì—ëŸ¬ ì‹¬ê°ë„ ('info'|'warning'|'error'|'critical')
   */
  showUserError(message, severity = 'error') {
    // UI ëª¨ë“ˆì´ ìžˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ í† ìŠ¤íŠ¸ ì‚¬ìš©
    if (typeof UI !== 'undefined' &amp;&amp; UI.showToast) {
      const duration = severity === 'critical' ? 10000 : severity === 'error' ? 5000 : 3000;
      UI.showToast(message, severity, duration);
    } else {
      this.showToast(message, severity);
    }
  },

  // ê°„ë‹¨í•œ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
  showToast(message, type = 'info') {
    const toastId = `toast-${Date.now()}`;
    const toast = document.createElement('div');
    toast.id = toastId;
    toast.className = `error-toast toast-${type}`;
    toast.innerHTML = `
      &lt;div class="toast-content">
        &lt;span class="toast-icon">${type === 'error' ? 'âš ï¸' : 'â„¹ï¸'}&lt;/span>
        &lt;span class="toast-message">${message}&lt;/span>
        &lt;button class="toast-close" onclick="document.getElementById('${toastId}').remove()">Ã—&lt;/button>
      &lt;/div>
    `;
    
    // ìŠ¤íƒ€ì¼ ì¶”ê°€
    toast.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: ${type === 'error' ? '#fee' : '#eff'};
      border: 1px solid ${type === 'error' ? '#fcc' : '#cff'};
      border-radius: 4px;
      padding: 12px;
      max-width: 300px;
      z-index: 10000;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    `;
    
    document.body.appendChild(toast);
    
    // 5ì´ˆ í›„ ìžë™ ì œê±°
    setTimeout(() => {
      const element = document.getElementById(toastId);
      if (element) element.remove();
    }, 5000);
  },

  // ì—ëŸ¬ ë¡œê·¸ ì¡°íšŒ
  getErrorLog() {
    return this.errorLog;
  },

  // ì—ëŸ¬ ë¡œê·¸ ì§€ìš°ê¸°
  clearErrorLog() {
    this.errorLog = [];
    console.log('ðŸ§¹ ì—ëŸ¬ ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.');
  },

  // ê°œë°œ ëª¨ë“œìš© ìƒì„¸ ì—ëŸ¬ í‘œì‹œ
  showDetailedError(error, context) {
    if (window.location.hostname === 'localhost') {
      console.group('ðŸ” ìƒì„¸ ì—ëŸ¬ ì •ë³´');
      console.error('Error:', error);
      console.log('Context:', context);
      console.log('Stack:', error.stack);
      console.groupEnd();
    }
  }
};

// ê¸€ë¡œë²Œ ì—ëŸ¬ í•¸ë“¤ëŸ¬ ë“±ë¡
window.addEventListener('error', (event) => {
  ErrorHandler.handleError(event.error, { 
    type: 'javascript',
    filename: event.filename,
    lineno: event.lineno,
    colno: event.colno
  });
});

window.addEventListener('unhandledrejection', (event) => {
  ErrorHandler.handleError(event.reason, { 
    type: 'promise',
    source: 'unhandledPromise'
  });
});

console.log('ðŸ›¡ï¸ ê¸€ë¡œë²Œ ì—ëŸ¬ ì²˜ë¦¬ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');

// === ëª¨ë“ˆ ì˜ì¡´ì„± ê²€ì¦ ì‹œìŠ¤í…œ ===

/**
 * ëª¨ë“ˆ ì˜ì¡´ì„± ê´€ë¦¬ìž (ModuleDependencyManager)
 * 
 * ê° ëª¨ë“ˆì˜ ë¡œë“œ ìƒíƒœì™€ ì˜ì¡´ì„±ì„ ì¶”ì í•˜ê³  ê²€ì¦í•˜ëŠ” ì‹œìŠ¤í…œìž…ë‹ˆë‹¤.
 * ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ ê´€ë¦¬í•˜ì—¬ ë¡œë“œ ìˆœì„œ ë¬¸ì œë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.
 * 
 * ì˜ì¡´ì„± êµ¬ì¡°:
 * - globals: ê¸°ì´ˆ ëª¨ë“ˆ (ì˜ì¡´ì„± ì—†ìŒ)
 * - utils: globals ì˜ì¡´
 * - api: globals, utils ì˜ì¡´
 * - data: globals, api ì˜ì¡´
 * - ui: globals, utils, data ì˜ì¡´
 * - events: globals, ui, data ì˜ì¡´
 * - app: ëª¨ë“  ëª¨ë“ˆì´ ë¡œë“œëœ í›„ ì‹¤í–‰ (ì§„ìž…ì )
 * 
 * @namespace ModuleDependencyManager
 */
const ModuleDependencyManager = {
  // ë¡œë“œëœ ëª¨ë“ˆë“¤ ì¶”ì 
  loadedModules: new Set(),
  
  // ëª¨ë“ˆë³„ ì˜ì¡´ì„± ì •ì˜
  dependencies: {
    app: [],                              // ì•±ì€ ì˜ì¡´ì„± ì—†ìŒ (ì§„ìž…ì )
    globals: [],                          // globalsëŠ” ì˜ì¡´ì„± ì—†ìŒ (ê¸°ì´ˆ)
    utils: ['globals'],                   // utilsëŠ” globalsì— ì˜ì¡´
    api: ['globals', 'utils'],           // apiëŠ” globals, utilsì— ì˜ì¡´
    data: ['globals', 'api'],           // dataëŠ” globals, apiì— ì˜ì¡´
    ui: ['globals', 'utils', 'data'],   // uiëŠ” globals, utils, dataì— ì˜ì¡´
    events: ['globals', 'ui', 'data']   // eventsëŠ” globals, ui, dataì— ì˜ì¡´
  },

  /**
   * ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ ë“±ë¡
   * 
   * ëª¨ë“ˆì´ ë¡œë“œ ì™„ë£Œë˜ë©´ ë“±ë¡í•˜ê³  ì˜ì¡´ì„±ì„ ìžë™ ê²€ì¦í•©ë‹ˆë‹¤.
   * exportëœ í•¨ìˆ˜/ê°ì²´ ê°œìˆ˜ë¥¼ í•¨ê»˜ ê¸°ë¡í•˜ì—¬ ëª¨ë“ˆ ìƒíƒœë¥¼ ì¶”ì í•©ë‹ˆë‹¤.
   * 
   * @param {string} moduleName - ë“±ë¡í•  ëª¨ë“ˆëª…
   * @param {number} exportCount - exportëœ í•¨ìˆ˜/ê°ì²´ ê°œìˆ˜
   * 
   * @example
   * ModuleDependencyManager.registerModule('utils', 5);
   */
  registerModule(moduleName, exportCount = 0) {
    this.loadedModules.add(moduleName);
    console.log(`ðŸ“¦ [${moduleName.toUpperCase()}] ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ (exports: ${exportCount}ê°œ)`);
    
    // ì˜ì¡´ì„± ê²€ì¦
    const dependencyCheck = this.checkDependencies(moduleName);
    if (dependencyCheck.success) {
      console.log(`âœ… [${moduleName.toUpperCase()}] ì˜ì¡´ì„± ê²€ì¦ ì„±ê³µ`);
    } else {
      console.warn(`âš ï¸ [${moduleName.toUpperCase()}] ì˜ì¡´ì„± ëˆ„ë½:`, dependencyCheck.missing);
    }
  },

  /**
   * íŠ¹ì • ëª¨ë“ˆì˜ ì˜ì¡´ì„± ê²€ì¦
   * @param {string} moduleName - ê²€ì¦í•  ëª¨ë“ˆëª…
   * @returns {Object} ê²€ì¦ ê²°ê³¼
   */
  checkDependencies(moduleName) {
    const requiredDeps = this.dependencies[moduleName] || [];
    const missing = requiredDeps.filter(dep => !this.loadedModules.has(dep));
    
    return {
      success: missing.length === 0,
      missing: missing,
      required: requiredDeps,
      loaded: Array.from(this.loadedModules)
    };
  },

  /**
   * ì „ì²´ ëª¨ë“ˆ ìƒíƒœ ë¦¬í¬íŠ¸
   */
  generateStatusReport() {
    console.group('ðŸ“‹ ëª¨ë“ˆ ì˜ì¡´ì„± ìƒíƒœ ë¦¬í¬íŠ¸');
    
    Object.keys(this.dependencies).forEach(moduleName => {
      const status = this.checkDependencies(moduleName);
      const isLoaded = this.loadedModules.has(moduleName);
      
      console.log(`${isLoaded ? 'âœ…' : 'âŒ'} ${moduleName}:`, {
        loaded: isLoaded,
        dependenciesOK: status.success,
        missing: status.missing
      });
    });
    
    console.groupEnd();
  },

  /**
   * ëª¨ë“ˆì´ ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸
   * @param {string} moduleName - í™•ì¸í•  ëª¨ë“ˆëª…
   * @returns {boolean} ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€
   */
  isModuleReady(moduleName) {
    const isLoaded = this.loadedModules.has(moduleName);
    const depsOK = this.checkDependencies(moduleName).success;
    return isLoaded &amp;&amp; depsOK;
  },

  /**
   * ëª¨ë“  í•µì‹¬ ëª¨ë“ˆì´ ì¤€ë¹„ë˜ì—ˆëŠ”ì§€ í™•ì¸
   * @returns {boolean} ì „ì²´ ì‹œìŠ¤í…œ ì¤€ë¹„ ìƒíƒœ
   */
  isSystemReady() {
    const coreModules = ['globals', 'utils', 'api', 'data', 'ui', 'events'];
    return coreModules.every(module => this.isModuleReady(module));
  }
};

// globals ëª¨ë“ˆ ìžì²´ ë“±ë¡
ModuleDependencyManager.registerModule('globals', Object.keys(GlobalState).length);

console.log('ðŸ”§ ëª¨ë“ˆ ì˜ì¡´ì„± ê²€ì¦ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì™„ë£Œ');

// === ê°œë°œìž ë””ë²„ê¹… ë„êµ¬ ì‹œìŠ¤í…œ ===

/**
 * ê°œë°œìž ë””ë²„ê¹… ë„êµ¬ ëª¨ìŒ
 * 
 * ê°œë°œ ë° ìš´ì˜ í™˜ê²½ì—ì„œ ì•± ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ë””ë²„ê¹…í•  ìˆ˜ ìžˆëŠ” ë„êµ¬ë“¤ì„ ì œê³µí•©ë‹ˆë‹¤.
 * ì½˜ì†” ëª…ë ¹ì–´, ìƒíƒœ ê²€ì‚¬, ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§, ì—ëŸ¬ ë¶„ì„ ë“±ì˜ ê¸°ëŠ¥ì„ í¬í•¨í•©ë‹ˆë‹¤.
 * 
 * @namespace DebugTools
 */
const DebugTools = {
  // ë””ë²„ê·¸ ëª¨ë“œ í”Œëž˜ê·¸
  isDebugMode: window.location.hostname === 'localhost' || window.location.search.includes('debug=true'),
  
  // ì„±ëŠ¥ ì¸¡ì • ì €ìž¥ì†Œ
  performanceLog: [],
  maxPerformanceEntries: 100,

  /**
   * ì•± ìƒíƒœ ì¢…í•© ê²€ì‚¬
   * 
   * í˜„ìž¬ ì•±ì˜ ì „ë°˜ì ì¸ ìƒíƒœë¥¼ ê²€ì‚¬í•˜ê³  ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
   * ëª¨ë“ˆ ë¡œë“œ ìƒíƒœ, ë°ì´í„° ìºì‹œ, ì—ëŸ¬ ë¡œê·¸ ë“±ì„ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.
   * 
   * @returns {Object} ìƒíƒœ ê²€ì‚¬ ë¦¬í¬íŠ¸
   */
  checkAppHealth() {
    const report = {
      timestamp: new Date().toISOString(),
      overall: 'unknown',
      checks: {}
    };

    try {
      // 1. ëª¨ë“ˆ ë¡œë“œ ìƒíƒœ ê²€ì‚¬
      report.checks.modules = this.checkModuleStatus();
      
      // 2. ì „ì—­ ìƒíƒœ ê²€ì‚¬
      report.checks.globalState = this.checkGlobalState();
      
      // 3. ì—ëŸ¬ ìƒíƒœ ê²€ì‚¬
      report.checks.errors = this.checkErrorStatus();
      
      // 4. ì„±ëŠ¥ ìƒíƒœ ê²€ì‚¬
      report.checks.performance = this.checkPerformanceStatus();
      
      // 5. FDK ì—°ê²° ìƒíƒœ ê²€ì‚¬
      report.checks.fdk = this.checkFDKStatus();
      
      // ì „ì²´ ìƒíƒœ íŒì •
      const healthyChecks = Object.values(report.checks).filter(check => check.status === 'healthy').length;
      const totalChecks = Object.keys(report.checks).length;
      
      if (healthyChecks === totalChecks) {
        report.overall = 'healthy';
      } else if (healthyChecks >= totalChecks * 0.7) {
        report.overall = 'warning';
      } else {
        report.overall = 'critical';
      }
      
      // ì½˜ì†”ì— ìƒíƒœ ë¦¬í¬íŠ¸ ì¶œë ¥
      this.printHealthReport(report);
      
      return report;
      
    } catch (error) {
      console.error('ðŸš¨ ìƒíƒœ ê²€ì‚¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
      report.overall = 'critical';
      report.error = error.message;
      return report;
    }
  },

  /**
   * ëª¨ë“ˆ ë¡œë“œ ìƒíƒœ ê²€ì‚¬
   */
  checkModuleStatus() {
    const moduleStatus = {
      status: 'unknown',
      details: {},
      loadedCount: 0,
      totalCount: 0
    };

    try {
      const expectedModules = ['globals', 'utils', 'api', 'data', 'ui', 'events', 'app'];
      moduleStatus.totalCount = expectedModules.length;
      
      expectedModules.forEach(moduleName => {
        const isLoaded = ModuleDependencyManager.loadedModules.has(moduleName);
        const hasExports = window[moduleName.charAt(0).toUpperCase() + moduleName.slice(1)] !== undefined;
        
        moduleStatus.details[moduleName] = {
          loaded: isLoaded,
          hasExports: hasExports,
          status: isLoaded &amp;&amp; hasExports ? 'ok' : 'missing'
        };
        
        if (isLoaded &amp;&amp; hasExports) {
          moduleStatus.loadedCount++;
        }
      });
      
      const loadRatio = moduleStatus.loadedCount / moduleStatus.totalCount;
      moduleStatus.status = loadRatio >= 0.8 ? 'healthy' : loadRatio >= 0.5 ? 'warning' : 'critical';
      
    } catch (error) {
      moduleStatus.status = 'error';
      moduleStatus.error = error.message;
    }

    return moduleStatus;
  },

  /**
   * ì „ì—­ ìƒíƒœ ê²€ì‚¬
   */
  checkGlobalState() {
    const stateStatus = {
      status: 'unknown',
      details: {}
    };

    try {
      const globalData = GlobalState.getGlobalTicketData();
      
      stateStatus.details = {
        isInitialized: GlobalState.getInitialized(),
        hasClient: !!GlobalState.getClient(),
        hasTicketData: !!globalData.ticket_info,
        hasSummary: !!globalData.summary,
        cachedTicketId: globalData.cached_ticket_id,
        isLoading: globalData.isLoading,
        lastLoadTime: globalData.lastLoadTime,
        cacheAge: globalData.lastLoadTime ? 
          Math.round((Date.now() - new Date(globalData.lastLoadTime).getTime()) / 1000) : null
      };
      
      // ìƒíƒœ ê±´ê°•ë„ íŒì •
      const healthyStates = [
        stateStatus.details.isInitialized,
        stateStatus.details.hasClient,
        !stateStatus.details.isLoading
      ].filter(Boolean).length;
      
      stateStatus.status = healthyStates >= 2 ? 'healthy' : 'warning';
      
    } catch (error) {
      stateStatus.status = 'error';
      stateStatus.error = error.message;
    }

    return stateStatus;
  },

  /**
   * ì—ëŸ¬ ìƒíƒœ ê²€ì‚¬
   */
  checkErrorStatus() {
    const errorStatus = {
      status: 'unknown',
      details: {}
    };

    try {
      const errorLog = GlobalState.ErrorHandler.errorLog;
      const recentErrors = errorLog.filter(error => {
        const errorTime = new Date(error.timestamp).getTime();
        const fiveMinutesAgo = Date.now() - (5 * 60 * 1000);
        return errorTime > fiveMinutesAgo;
      });
      
      const criticalErrors = errorLog.filter(error => 
        error.context.severity === 'critical'
      );
      
      errorStatus.details = {
        totalErrors: errorLog.length,
        recentErrors: recentErrors.length,
        criticalErrors: criticalErrors.length,
        lastError: errorLog[0] ? {
          timestamp: errorLog[0].timestamp,
          message: errorLog[0].message,
          module: errorLog[0].context.module
        } : null
      };
      
      // ì—ëŸ¬ ìƒíƒœ íŒì •
      if (criticalErrors.length > 0) {
        errorStatus.status = 'critical';
      } else if (recentErrors.length > 3) {
        errorStatus.status = 'warning';
      } else {
        errorStatus.status = 'healthy';
      }
      
    } catch (error) {
      errorStatus.status = 'error';
      errorStatus.error = error.message;
    }

    return errorStatus;
  },

  /**
   * ì„±ëŠ¥ ìƒíƒœ ê²€ì‚¬
   */
  checkPerformanceStatus() {
    const perfStatus = {
      status: 'unknown',
      details: {}
    };

    try {
      const navigation = performance.getEntriesByType('navigation')[0];
      const resources = performance.getEntriesByType('resource');
      
      perfStatus.details = {
        pageLoadTime: navigation ? Math.round(navigation.loadEventEnd - navigation.fetchStart) : null,
        domContentLoaded: navigation ? Math.round(navigation.domContentLoadedEventEnd - navigation.fetchStart) : null,
        resourceCount: resources.length,
        memoryUsage: performance.memory ? {
          used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
          total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024),
          limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)
        } : null
      };
      
      // ì„±ëŠ¥ ìƒíƒœ íŒì •
      const loadTime = perfStatus.details.pageLoadTime;
      if (loadTime &lt; 2000) {
        perfStatus.status = 'healthy';
      } else if (loadTime &lt; 5000) {
        perfStatus.status = 'warning';
      } else {
        perfStatus.status = 'critical';
      }
      
    } catch (error) {
      perfStatus.status = 'error';
      perfStatus.error = error.message;
    }

    return perfStatus;
  },

  /**
   * FDK ì—°ê²° ìƒíƒœ ê²€ì‚¬
   */
  checkFDKStatus() {
    const fdkStatus = {
      status: 'unknown',
      details: {}
    };

    try {
      const hasParentApp = typeof window.parent !== 'undefined' &amp;&amp; window.parent !== window;
      const hasAppObject = hasParentApp &amp;&amp; typeof window.parent.app !== 'undefined';
      const client = GlobalState.getClient();
      
      fdkStatus.details = {
        hasParentWindow: hasParentApp,
        hasAppObject: hasAppObject,
        hasClient: !!client,
        isDevelopment: window.location.hostname === 'localhost',
        currentUrl: window.location.href
      };
      
      // FDK ìƒíƒœ íŒì •
      if (fdkStatus.details.isDevelopment || (hasParentApp &amp;&amp; hasAppObject &amp;&amp; client)) {
        fdkStatus.status = 'healthy';
      } else if (hasParentApp) {
        fdkStatus.status = 'warning';
      } else {
        fdkStatus.status = 'critical';
      }
      
    } catch (error) {
      fdkStatus.status = 'error';
      fdkStatus.error = error.message;
    }

    return fdkStatus;
  },

  /**
   * ìƒíƒœ ë¦¬í¬íŠ¸ ì½˜ì†” ì¶œë ¥
   */
  printHealthReport(report) {
    const statusEmoji = {
      healthy: 'âœ…',
      warning: 'âš ï¸',
      critical: 'ðŸš¨',
      error: 'ðŸ’¥',
      unknown: 'â“'
    };

    console.group(`ðŸ” ì•± ìƒíƒœ ê²€ì‚¬ ë¦¬í¬íŠ¸ ${statusEmoji[report.overall]} ${report.overall.toUpperCase()}`);
    console.log(`ðŸ•’ ê²€ì‚¬ ì‹œê°„: ${report.timestamp}`);
    
    Object.entries(report.checks).forEach(([category, check]) => {
      console.group(`${statusEmoji[check.status]} ${category.toUpperCase()}: ${check.status}`);
      if (check.details) {
        console.table(check.details);
      }
      if (check.error) {
        console.error('ì˜¤ë¥˜:', check.error);
      }
      console.groupEnd();
    });
    
    console.groupEnd();
  },

  /**
   * ì½˜ì†” ëª…ë ¹ì–´ ë“±ë¡
   * 
   * ê°œë°œìž ì½˜ì†”ì—ì„œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” ë””ë²„ê¹… ëª…ë ¹ì–´ë“¤ì„ ë“±ë¡í•©ë‹ˆë‹¤.
   */
  registerConsoleCommands() {
    if (!this.isDebugMode) return;

    // ì „ì—­ ë””ë²„ê¹… ëª…ë ¹ì–´ë“¤
    window.debug = {
      // ìƒíƒœ ê²€ì‚¬
      health: () => this.checkAppHealth(),
      
      // ëª¨ë“ˆ ìƒíƒœ
      modules: () => {
        console.table(Array.from(ModuleDependencyManager.loadedModules));
        return ModuleDependencyManager;
      },
      
      // ì—ëŸ¬ ë¡œê·¸
      errors: () => {
        console.table(GlobalState.ErrorHandler.errorLog);
        return GlobalState.ErrorHandler.errorLog;
      },
      
      // ì „ì—­ ìƒíƒœ
      state: () => {
        console.table(GlobalState.getGlobalTicketData());
        return GlobalState.getGlobalTicketData();
      },
      
      // ìºì‹œ ì´ˆê¸°í™”
      reset: () => {
        GlobalState.resetGlobalTicketCache();
        console.log('ðŸ”„ ì „ì—­ ìºì‹œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
      },
      
      // ì„±ëŠ¥ ì •ë³´
      perf: () => {
        const navigation = performance.getEntriesByType('navigation')[0];
        console.table({
          'íŽ˜ì´ì§€ ë¡œë“œ': `${Math.round(navigation.loadEventEnd - navigation.fetchStart)}ms`,
          'DOM ì¤€ë¹„': `${Math.round(navigation.domContentLoadedEventEnd - navigation.fetchStart)}ms`,
          'ë¦¬ì†ŒìŠ¤ ìˆ˜': performance.getEntriesByType('resource').length
        });
      }
    };

    console.log('ðŸ› ï¸ ë””ë²„ê¹… ëª…ë ¹ì–´ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. window.debug ê°ì²´ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    console.log('ì‚¬ìš© ì˜ˆì‹œ: debug.health(), debug.modules(), debug.errors()');
  },

  /**
   * ì„±ëŠ¥ ìµœì í™” ìƒíƒœ ëª¨ë‹ˆí„°ë§
   */
  getPerformanceReport() {
    if (!window.PerformanceOptimizer) {
      return 'âŒ PerformanceOptimizerë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
    }
    
    const memoryStats = window.PerformanceOptimizer.getMemoryStats();
    const cacheStats = memoryStats.cacheStats;
    
    return {
      ë©”ëª¨ë¦¬_ì‚¬ìš©ëŸ‰: memoryStats.memoryUsage,
      ìºì‹œ_ìƒíƒœ: {
        í•¨ìˆ˜_ìºì‹œ: `${memoryStats.functionCache}ê°œ`,
        ê²°ê³¼_ìºì‹œ: `${memoryStats.resultCache}ê°œ`,
        DOM_ìºì‹œ: `${memoryStats.domCache}ê°œ`
      },
      ìºì‹œ_ì„±ëŠ¥: {
        ížˆíŠ¸ìœ¨: `${(cacheStats.hits / (cacheStats.hits + cacheStats.misses) * 100).toFixed(1)}%`,
        ì „ì²´_ìš”ì²­: cacheStats.hits + cacheStats.misses,
        ìºì‹œ_ížˆíŠ¸: cacheStats.hits,
        ìºì‹œ_ë¯¸ìŠ¤: cacheStats.misses,
        ìºì‹œ_ì œê±°: cacheStats.evictions
      },
      ìµœì í™”_ê¶Œìž¥ì‚¬í•­: this.getOptimizationRecommendations(memoryStats)
    };
  },

  /**
   * ìµœì í™” ê¶Œìž¥ì‚¬í•­ ìƒì„±
   */
  getOptimizationRecommendations(stats) {
    const recommendations = [];
    
    // ìºì‹œ ížˆíŠ¸ìœ¨ ë¶„ì„
    const hitRate = stats.cacheStats.hits / (stats.cacheStats.hits + stats.cacheStats.misses);
    if (hitRate &lt; 0.6) {
      recommendations.push('ìºì‹œ ížˆíŠ¸ìœ¨ì´ ë‚®ìŠµë‹ˆë‹¤. ìºì‹œ TTLì„ ëŠ˜ë¦¬ê±°ë‚˜ ìžì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì˜ ìºì‹œ ì „ëžµì„ ê²€í† í•˜ì„¸ìš”.');
    }
    
    // ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„
    if (typeof window.performance.memory !== 'undefined') {
      const memoryUsage = window.performance.memory.usedJSHeapSize / window.performance.memory.totalJSHeapSize;
      if (memoryUsage > 0.8) {
        recommendations.push('ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ë†’ìŠµë‹ˆë‹¤. ìºì‹œ í¬ê¸°ë¥¼ ì¤„ì´ê±°ë‚˜ ë©”ëª¨ë¦¬ ì •ë¦¬ë¥¼ ìˆ˜í–‰í•˜ì„¸ìš”.');
      }
    }
    
    // DOM ìºì‹œ ë¶„ì„
    if (stats.domCache > 50) {
      recommendations.push('DOM ìºì‹œê°€ ë§ŽìŠµë‹ˆë‹¤. ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” DOM ìš”ì†Œ ì°¸ì¡°ë¥¼ ì •ë¦¬í•˜ì„¸ìš”.');
    }
    
    if (recommendations.length === 0) {
      recommendations.push('ì„±ëŠ¥ ìƒíƒœê°€ ì–‘í˜¸í•©ë‹ˆë‹¤. ðŸ‘');
    }
    
    return recommendations;
  },

  /**
   * ëª¨ë“  ìºì‹œ ì´ˆê¸°í™”
   */
  clearAllCaches() {
    if (window.PerformanceOptimizer) {
      window.PerformanceOptimizer.clearAllCaches();
      console.log('ðŸ§¹ ëª¨ë“  ìºì‹œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
    
    if (window.API &amp;&amp; window.API.clearCache) {
      window.API.clearCache();
    }
    
    if (window.GlobalState) {
      window.GlobalState.resetGlobalTicketCache();
    }
  },

  /**
   * ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
   */
  async runPerformanceBenchmark() {
    console.log('ðŸƒâ€â™‚ï¸ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ì‹œìž‘...');
    
    const results = {
      DOM_ì¡°ìž‘: await this.benchmarkDOMOperations(),
      API_í˜¸ì¶œ: await this.benchmarkAPIOperations(),
      ë°ì´í„°_ì²˜ë¦¬: await this.benchmarkDataProcessing(),
      ìºì‹œ_ì„±ëŠ¥: await this.benchmarkCachePerformance()
    };
    
    console.log('ðŸ“Š ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼:', results);
    return results;
  },

  /**
   * DOM ì¡°ìž‘ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
   */
  async benchmarkDOMOperations() {
    const iterations = 1000;
    const container = document.createElement('div');
    document.body.appendChild(container);
    
    // ê¸°ë³¸ DOM ì¡°ìž‘ í…ŒìŠ¤íŠ¸
    const start1 = performance.now();
    for (let i = 0; i &lt; iterations; i++) {
      const div = document.createElement('div');
      div.textContent = `Item ${i}`;
      container.appendChild(div);
    }
    const basicTime = performance.now() - start1;
    
    // ë°°ì¹˜ DOM ì—…ë°ì´íŠ¸ í…ŒìŠ¤íŠ¸
    container.innerHTML = '';
    const start2 = performance.now();
    
    if (window.PerformanceOptimizer) {
      const updates = Array.from({length: iterations}, (_, i) => ({
        type: 'create',
        tag: 'div',
        properties: { textContent: `Item ${i}` },
        parent: container
      }));
      await window.PerformanceOptimizer.batchDOMUpdates(updates);
    }
    
    const batchTime = performance.now() - start2;
    
    // ì •ë¦¬
    document.body.removeChild(container);
    
    return {
      ê¸°ë³¸_DOM_ì¡°ìž‘: `${basicTime.toFixed(2)}ms`,
      ë°°ì¹˜_DOM_ì—…ë°ì´íŠ¸: `${batchTime.toFixed(2)}ms`,
      ì„±ëŠ¥_í–¥ìƒ: `${((basicTime - batchTime) / basicTime * 100).toFixed(1)}%`
    };
  },

  /**
   * API í˜¸ì¶œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
   */
  async benchmarkAPIOperations() {
    if (!window.API || !window.API.healthCheck) {
      return 'âŒ API ëª¨ë“ˆì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
    }
    
    const iterations = 5;
    const times = [];
    
    for (let i = 0; i &lt; iterations; i++) {
      const start = performance.now();
      try {
        await window.API.healthCheck();
      } catch (error) {
        // ì—ëŸ¬ ë¬´ì‹œ
      }
      times.push(performance.now() - start);
    }
    
    const avgTime = times.reduce((a, b) => a + b, 0) / times.length;
    const minTime = Math.min(...times);
    const maxTime = Math.max(...times);
    
    return {
      í‰ê· _ì‘ë‹µì‹œê°„: `${avgTime.toFixed(2)}ms`,
      ìµœì†Œ_ì‘ë‹µì‹œê°„: `${minTime.toFixed(2)}ms`,
      ìµœëŒ€_ì‘ë‹µì‹œê°„: `${maxTime.toFixed(2)}ms`
    };
  },

  /**
   * ë°ì´í„° ì²˜ë¦¬ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
   */
  async benchmarkDataProcessing() {
    const testData = Array.from({length: 1000}, (_, i) => ({
      id: i,
      title: `Test Item ${i}`,
      description: `Description for item ${i}`,
      timestamp: new Date().toISOString()
    }));
    
    // ê¸°ë³¸ ì²˜ë¦¬
    const start1 = performance.now();
    const processed1 = testData.map(item => ({
      ...item,
      processed: true,
      searchText: `${item.title} ${item.description}`.toLowerCase()
    }));
    const basicTime = performance.now() - start1;
    
    // ë°°ì¹˜ ì²˜ë¦¬ (Data ëª¨ë“ˆ ì‚¬ìš©)
    const start2 = performance.now();
    let processed2 = [];
    
    if (window.Data &amp;&amp; window.Data.processBatchData) {
      processed2 = await window.Data.processBatchData(
        testData,
        (item) => ({
          ...item,
          processed: true,
          searchText: `${item.title} ${item.description}`.toLowerCase()
        }),
        { batchSize: 100, delay: 1 }
      );
    }
    
    const batchTime = performance.now() - start2;
    
    return {
      ê¸°ë³¸_ì²˜ë¦¬: `${basicTime.toFixed(2)}ms`,
      ë°°ì¹˜_ì²˜ë¦¬: `${batchTime.toFixed(2)}ms`,
      ì²˜ë¦¬_ê²°ê³¼: `${processed1.length}ê°œ í•­ëª©`,
      ë°°ì¹˜_ê²°ê³¼: `${processed2.length}ê°œ í•­ëª©`
    };
  },

  /**
   * ìºì‹œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
   */
  async benchmarkCachePerformance() {
    if (!window.PerformanceOptimizer) {
      return 'âŒ PerformanceOptimizerë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
    }
    
    // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ (CPU ì§‘ì•½ì  ìž‘ì—… ì‹œë®¬ë ˆì´ì…˜)
    const heavyFunction = (n) => {
      let result = 0;
      for (let i = 0; i &lt; n * 1000; i++) {
        result += Math.sqrt(i);
      }
      return result;
    };
    
    // ë©”ëª¨ì´ì œì´ì…˜ ì—†ì´ í…ŒìŠ¤íŠ¸
    const start1 = performance.now();
    const results1 = [];
    for (let i = 0; i &lt; 10; i++) {
      results1.push(heavyFunction(100));
    }
    const normalTime = performance.now() - start1;
    
    // ë©”ëª¨ì´ì œì´ì…˜ ì ìš© í…ŒìŠ¤íŠ¸
    const memoizedFunction = window.PerformanceOptimizer.memoize(heavyFunction);
    const start2 = performance.now();
    const results2 = [];
    for (let i = 0; i &lt; 10; i++) {
      results2.push(memoizedFunction(100)); // ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¡œ í˜¸ì¶œ
    }
    const memoizedTime = performance.now() - start2;
    
    return {
      ì¼ë°˜_í•¨ìˆ˜_í˜¸ì¶œ: `${normalTime.toFixed(2)}ms`,
      ë©”ëª¨ì´ì œì´ì…˜_í•¨ìˆ˜_í˜¸ì¶œ: `${memoizedTime.toFixed(2)}ms`,
      ì„±ëŠ¥_í–¥ìƒ: `${((normalTime - memoizedTime) / normalTime * 100).toFixed(1)}%`,
      ìºì‹œ_ìƒíƒœ: memoizedFunction.getCacheStats()
    };
  },
};

// ê°œë°œ ëª¨ë“œì—ì„œ ë””ë²„ê¹… ë„êµ¬ ì´ˆê¸°í™”
if (DebugTools.isDebugMode) {
  DebugTools.registerConsoleCommands();
  
  // ì£¼ê¸°ì  ìƒíƒœ ëª¨ë‹ˆí„°ë§ (5ë¶„ë§ˆë‹¤)
  setInterval(() => {
    const report = DebugTools.checkAppHealth();
    if (report.overall === 'critical') {
      console.warn('ðŸš¨ ì•± ìƒíƒœê°€ ì‹¬ê°í•©ë‹ˆë‹¤! ì—ëŸ¬ ë¡œê·¸ ë° ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.');
    }
  }, 300000);
}

// === ì„±ëŠ¥ ìµœì í™” ë° ìºì‹± ì‹œìŠ¤í…œ ===
// í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜, ìŠ¤ë§ˆíŠ¸ ìºì‹±, ë©”ëª¨ë¦¬ ê´€ë¦¬ ì œê³µ
class PerformanceOptimizer {
    constructor() {
        this.functionCache = new Map();
        this.resultCache = new Map();
        this.domCache = new Map();
        this.memoryThreshold = 50 * 1024 * 1024; // 50MB
        this.maxCacheSize = 100;
        this.cacheStats = {
            hits: 0,
            misses: 0,
            evictions: 0
        };
        this.setupMemoryMonitoring();
    }

    /**
     * í•¨ìˆ˜ ë©”ëª¨ì´ì œì´ì…˜
     * ë™ì¼í•œ ìž…ë ¥ì— ëŒ€í•´ ê²°ê³¼ë¥¼ ìºì‹œí•˜ì—¬ ì„±ëŠ¥ í–¥ìƒ
     */
    memoize(fn, keyGenerator = null) {
        const cache = new Map();
        const memoizedFunction = (...args) => {
            const key = keyGenerator ? keyGenerator(...args) : JSON.stringify(args);
            
            if (cache.has(key)) {
                this.cacheStats.hits++;
                return cache.get(key);
            }
            
            this.cacheStats.misses++;
            const result = fn.apply(this, args);
            
            // ìºì‹œ í¬ê¸° ì œí•œ
            if (cache.size >= this.maxCacheSize) {
                const firstKey = cache.keys().next().value;
                cache.delete(firstKey);
                this.cacheStats.evictions++;
            }
            
            cache.set(key, result);
            return result;
        };
        
        // ìºì‹œ ì •ë¦¬ ë©”ì„œë“œ ì¶”ê°€
        memoizedFunction.clearCache = () => cache.clear();
        memoizedFunction.getCacheSize = () => cache.size;
        memoizedFunction.getCacheStats = () => ({ ...this.cacheStats });
        
        return memoizedFunction;
    }

    /**
     * ìŠ¤ë§ˆíŠ¸ API ê²°ê³¼ ìºì‹±
     * TTL(Time To Live) ê¸°ë°˜ ìžë™ ë§Œë£Œ
     */
    cacheApiResult(key, result, ttlMs = 300000) { // ê¸°ë³¸ 5ë¶„
        const cacheEntry = {
            data: result,
            timestamp: Date.now(),
            ttl: ttlMs,
            accessCount: 0
        };
        
        this.resultCache.set(key, cacheEntry);
        this.cleanExpiredCache();
    }

    getCachedApiResult(key) {
        const entry = this.resultCache.get(key);
        if (!entry) return null;
        
        // TTL í™•ì¸
        if (Date.now() - entry.timestamp > entry.ttl) {
            this.resultCache.delete(key);
            return null;
        }
        
        entry.accessCount++;
        entry.timestamp = Date.now(); // LRU ì—…ë°ì´íŠ¸
        return entry.data;
    }

    /**
     * DOM ìš”ì†Œ ìºì‹±
     * ìžì£¼ ì ‘ê·¼í•˜ëŠ” DOM ìš”ì†Œë¥¼ ìºì‹œí•˜ì—¬ querySelector í˜¸ì¶œ ìµœì†Œí™”
     */
    getDOMElement(selector, forceRefresh = false) {
        if (!forceRefresh &amp;&amp; this.domCache.has(selector)) {
            const element = this.domCache.get(selector);
            // ìš”ì†Œê°€ ì—¬ì „ížˆ DOMì— ì¡´ìž¬í•˜ëŠ”ì§€ í™•ì¸
            if (document.contains(element)) {
                return element;
            }
            this.domCache.delete(selector);
        }
        
        const element = document.querySelector(selector);
        if (element) {
            this.domCache.set(selector, element);
        }
        return element;
    }

    /**
     * ë°°ì¹˜ DOM ì—…ë°ì´íŠ¸
     * DOM ì¡°ìž‘ì„ ë°°ì¹˜ ì²˜ë¦¬í•˜ì—¬ ë¦¬í”Œë¡œìš°/ë¦¬íŽ˜ì¸íŠ¸ ìµœì†Œí™”
     */
    batchDOMUpdates(updates) {
        return new Promise(resolve => {
            requestAnimationFrame(() => {
                // DocumentFragmentë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì¹˜ ì—…ë°ì´íŠ¸
                const fragment = document.createDocumentFragment();
                const elements = [];
                
                updates.forEach(update => {
                    if (update.type === 'create') {
                        const element = document.createElement(update.tag);
                        if (update.properties) {
                            Object.assign(element, update.properties);
                        }
                        if (update.attributes) {
                            Object.entries(update.attributes).forEach(([key, value]) => {
                                element.setAttribute(key, value);
                            });
                        }
                        elements.push({ element, parent: update.parent });
                    } else if (update.type === 'modify') {
                        const element = update.element;
                        if (update.properties) {
                            Object.assign(element, update.properties);
                        }
                        if (update.styles) {
                            Object.assign(element.style, update.styles);
                        }
                    }
                });
                
                // ì‹¤ì œ DOMì— ì ìš©
                elements.forEach(({ element, parent }) => {
                    if (parent) {
                        parent.appendChild(element);
                    }
                });
                
                resolve();
            });
        });
    }

    /**
     * ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
     */
    setupMemoryMonitoring() {
        if ('memory' in performance) {
            setInterval(() => {
                const memInfo = performance.memory;
                if (memInfo.usedJSHeapSize > this.memoryThreshold) {
                    console.warn('ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ ìž„ê³„ê°’ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤:', {
                        used: this.formatBytes(memInfo.usedJSHeapSize),
                        total: this.formatBytes(memInfo.totalJSHeapSize),
                        threshold: this.formatBytes(this.memoryThreshold)
                    });
                    this.performMemoryCleanup();
                }
            }, 30000); // 30ì´ˆë§ˆë‹¤ í™•ì¸
        }
    }

    /**
     * ë©”ëª¨ë¦¬ ì •ë¦¬
     */
    performMemoryCleanup() {
        // ë§Œë£Œëœ ìºì‹œ ì •ë¦¬
        this.cleanExpiredCache();
        
        // DOM ìºì‹œ ì •ë¦¬ (ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” ìš”ì†Œ ì œê±°)
        for (const [selector, element] of this.domCache.entries()) {
            if (!document.contains(element)) {
                this.domCache.delete(selector);
            }
        }
        
        // í•¨ìˆ˜ ìºì‹œ í¬ê¸° ì œí•œ
        if (this.functionCache.size > this.maxCacheSize) {
            const keysToDelete = Array.from(this.functionCache.keys()).slice(0, 10);
            keysToDelete.forEach(key => this.functionCache.delete(key));
        }
        
        console.log('ë©”ëª¨ë¦¬ ì •ë¦¬ ì™„ë£Œ:', this.getMemoryStats());
    }

    cleanExpiredCache() {
        const now = Date.now();
        for (const [key, entry] of this.resultCache.entries()) {
            if (now - entry.timestamp > entry.ttl) {
                this.resultCache.delete(key);
            }
        }
    }

    /**
     * ì§€ì—° ë¡œë”© ì§€ì›
     */
    createLazyLoader(loadFunction, placeholder = null) {
        let loaded = false;
        let loadPromise = null;
        
        return {
            load: () => {
                if (loaded) return Promise.resolve();
                if (loadPromise) return loadPromise;
                
                loadPromise = loadFunction().then(() => {
                    loaded = true;
                    return true;
                });
                
                return loadPromise;
            },
            isLoaded: () => loaded,
            getPlaceholder: () => placeholder
        };
    }

    /**
     * ë””ë°”ìš´ìŠ¤ ë° ìŠ¤ë¡œí‹€ë§
     */
    debounce(func, wait, immediate = false) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                timeout = null;
                if (!immediate) func.apply(this, args);
            };
            const callNow = immediate &amp;&amp; !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) func.apply(this, args);
        };
    }

    throttle(func, limit) {
        let inThrottle;
        return function executedFunction(...args) {
            if (!inThrottle) {
                func.apply(this, args);
                inThrottle = true;
                setTimeout(() => inThrottle = false, limit);
            }
        };
    }

    /**
     * ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
     */
    measurePerformance(name, fn) {
        return (...args) => {
            const startTime = performance.now();
            const result = fn.apply(this, args);
            const endTime = performance.now();
            
            console.log(`[ì„±ëŠ¥] ${name}: ${(endTime - startTime).toFixed(2)}ms`);
            return result;
        };
    }

    /**
     * ìœ í‹¸ë¦¬í‹° ë©”ì„œë“œë“¤
     */
    formatBytes(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    getMemoryStats() {
        return {
            functionCache: this.functionCache.size,
            resultCache: this.resultCache.size,
            domCache: this.domCache.size,
            cacheStats: { ...this.cacheStats },
            memoryUsage: 'memory' in performance ? {
                used: this.formatBytes(performance.memory.usedJSHeapSize),
                total: this.formatBytes(performance.memory.totalJSHeapSize)
            } : 'N/A'
        };
    }

    /**
     * ìºì‹œ ìƒíƒœ ì´ˆê¸°í™”
     */
    clearAllCaches() {
        this.functionCache.clear();
        this.resultCache.clear();
        this.domCache.clear();
        this.cacheStats = { hits: 0, misses: 0, evictions: 0 };
        console.log('ëª¨ë“  ìºì‹œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }
}

// ì „ì—­ ì„±ëŠ¥ ìµœì í™” ì¸ìŠ¤í„´ìŠ¤
window.PerformanceOptimizer = new PerformanceOptimizer();

// ë””ë²„ê¹… ë„êµ¬ì™€ ì˜ì¡´ì„± ê´€ë¦¬ìžë¥¼ ì „ì—­ìœ¼ë¡œ export
window.DebugTools = DebugTools;
window.ModuleDependencyManager = ModuleDependencyManager;

console.log('ðŸš€ globals.js ì „ì²´ ë¡œë“œ ì™„ë£Œ - ëª¨ë“  ì‹œìŠ¤í…œ ì¤€ë¹„ë¨');
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="global.html#API">API</a></li><li><a href="Data.html">Data</a></li><li><a href="DebugTools.html">DebugTools</a></li><li><a href="Events.html">Events</a></li><li><a href="GlobalState.html">GlobalState</a></li><li><a href="ModuleDependencyManager.html">ModuleDependencyManager</a></li><li><a href="UI.html">UI</a></li><li><a href="Utils.html">Utils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#callBackendAPI">callBackendAPI</a></li><li><a href="global.html#client">client</a></li><li><a href="global.html#debugGlobalState">debugGlobalState</a></li><li><a href="global.html#extractCompanyIdFromDomain">extractCompanyIdFromDomain</a></li><li><a href="global.html#getFreshdeskConfigFromIparams">getFreshdeskConfigFromIparams</a></li><li><a href="global.html#getGlobalLoading">getGlobalLoading</a></li><li><a href="global.html#getGlobalTicketData">getGlobalTicketData</a></li><li><a href="global.html#getInitialized">getInitialized</a></li><li><a href="global.html#globalTicketData">globalTicketData</a></li><li><a href="global.html#initializeApp">initializeApp</a></li><li><a href="global.html#isGlobalDataValid">isGlobalDataValid</a></li><li><a href="global.html#isInitialized">isInitialized</a></li><li><a href="global.html#loadInitialDataFromBackend">loadInitialDataFromBackend</a></li><li><a href="global.html#loadSimilarTicketsFromBackend">loadSimilarTicketsFromBackend</a></li><li><a href="global.html#resetGlobalTicketCache">resetGlobalTicketCache</a></li><li><a href="global.html#setGlobalLoading">setGlobalLoading</a></li><li><a href="global.html#setInitialized">setInitialized</a></li><li><a href="global.html#showErrorInResults">showErrorInResults</a></li><li><a href="global.html#showLoadingInResults">showLoadingInResults</a></li><li><a href="global.html#smartDomainParsingFrontend">smartDomainParsingFrontend</a></li><li><a href="global.html#updateGlobalTicketData">updateGlobalTicketData</a></li><li><a href="global.html#validateAndInitializeApp">validateAndInitializeApp</a></li><li><a href="global.html#validateGlobalState">validateGlobalState</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Mon Jun 16 2025 23:16:45 GMT+0900 (ëŒ€í•œë¯¼êµ­ í‘œì¤€ì‹œ)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
