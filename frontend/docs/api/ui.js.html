<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ui.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ui.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * UI ë Œë”ë§ ëª¨ë“ˆ (UI)
 * 
 * Freshdesk Custom App - Prompt Canvas
 * ì´ íŒŒì¼ì€ app.jsì—ì„œ ë¶„ë¦¬ëœ ëª¨ë“  UI ë Œë”ë§ê³¼ í‘œì‹œ ê´€ë ¨ í•¨ìˆ˜ë“¤ì„ í¬í•¨í•©ë‹ˆë‹¤.
 * 
 * ì£¼ìš” ê¸°ëŠ¥:
 * - ì•ˆì „í•œ DOM ìš”ì†Œ ì¡°ì‘ ë° ì ‘ê·¼
 * - í‹°ì¼“ ì •ë³´ ë° ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
 * - ëª¨ë‹¬ ì°½ ë° ìƒì„¸ ë·° í‘œì‹œ ê´€ë¦¬
 * - í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ë° ì‚¬ìš©ì í”¼ë“œë°±
 * - ë¡œë”© ìƒíƒœ ë° ì—ëŸ¬ ìƒíƒœ UI
 * - ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ ë° ë·° ì „í™˜
 * 
 * ì˜ì¡´ì„±:
 * - GlobalState: ì „ì—­ ìƒíƒœ ë° ì—ëŸ¬ í•¸ë“¤ëŸ¬
 * - Utils: ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ (ë‚ ì§œ í¬ë§·, í…ìŠ¤íŠ¸ ì²˜ë¦¬ ë“±)
 * 
 * @namespace UI
 * @author Freshdesk Custom App Team
 * @since 1.0.0
 */

// UI ëª¨ë“ˆ ì •ì˜ - ëª¨ë“  UI ê´€ë ¨ í•¨ìˆ˜ë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ ê´€ë¦¬
window.UI = {
  /**
   * ì•ˆì „í•œ DOM ìš”ì†Œ ì¡°íšŒ
   * 
   * querySelectorë¥¼ ì•ˆì „í•˜ê²Œ ë˜í•‘í•˜ì—¬ ì—ëŸ¬ ì²˜ë¦¬ì™€ ë¡œê¹…ì„ ì œê³µí•©ë‹ˆë‹¤.
   * ìš”ì†Œê°€ ì—†ê±°ë‚˜ ì ‘ê·¼ ì˜¤ë¥˜ ì‹œ nullì„ ë°˜í™˜í•˜ê³  ì ì ˆí•œ ë¡œê·¸ë¥¼ ë‚¨ê¹ë‹ˆë‹¤.
   * 
   * @param {string} selector - CSS ì„ íƒì
   * @returns {Element|null} DOM ìš”ì†Œ ë˜ëŠ” null
   * 
   * @example
   * const button = UI.safeGetElement('#submit-button');
   * if (button) {
   *   button.addEventListener('click', handler);
   * }
   */
  safeGetElement(selector) {
    try {
      const element = document.querySelector(selector);
      if (!element) {
        console.warn(`[UI] ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${selector}`);
        return null;
      }
      return element;
    } catch (error) {
      console.error(`[UI] DOM ìš”ì†Œ ì¡°íšŒ ì˜¤ë¥˜: ${selector}`, error);
      GlobalState.ErrorHandler.handleError(error, {
        context: 'ui_dom_access',
        userMessage: 'UI ìš”ì†Œì— ì ‘ê·¼í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      });
      return null;
    }
  },

  /**
   * í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
   * 
   * ì‚¬ìš©ìì—ê²Œ ì„ì‹œ ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
   * ì„±ê³µ, ì˜¤ë¥˜, ê²½ê³ , ì •ë³´ ë“± ë‹¤ì–‘í•œ íƒ€ì…ì„ ì§€ì›í•˜ë©°
   * ìë™ìœ¼ë¡œ ì‚¬ë¼ì§€ëŠ” ì‹œê°„ì„ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   * 
   * @param {string} message - í‘œì‹œí•  ë©”ì‹œì§€
   * @param {string} type - ë©”ì‹œì§€ íƒ€ì… ('info'|'success'|'warning'|'error')
   * @param {number} duration - í‘œì‹œ ì‹œê°„ (ë°€ë¦¬ì´ˆ, ê¸°ë³¸ê°’: 3000)
   * 
   * @example
   * UI.showToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
   * UI.showToast('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error', 5000);
   */
  showToast(message, type = 'info', duration = 3000) {
    try {
      console.log(`[UI] í† ìŠ¤íŠ¸ í‘œì‹œ: ${type} - ${message}`);
      
      // ê¸°ì¡´ í† ìŠ¤íŠ¸ ì œê±°
      const existingToast = this.safeGetElement('.toast-message');
      if (existingToast) {
        existingToast.remove();
      }

      // í† ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ ìƒì„±
      const toast = document.createElement('div');
      toast.className = `toast-message toast-${type}`;
      toast.textContent = message;
      
      // ìŠ¤íƒ€ì¼ ì ìš©
      Object.assign(toast.style, {
        position: 'fixed',
        top: '20px',
        right: '20px',
        padding: '12px 20px',
        borderRadius: '4px',
        color: 'white',
        fontSize: '14px',
        zIndex: '10000',
        maxWidth: '300px',
        backgroundColor: type === 'error' ? '#f44336' : 
                       type === 'success' ? '#4caf50' : 
                       type === 'warning' ? '#ff9800' : '#2196f3'
      });

      document.body.appendChild(toast);

      // ìë™ ì œê±°
      setTimeout(() => {
        if (toast.parentNode) {
          toast.remove();
        }
      }, duration);
      
    } catch (error) {
      console.error('[UI] í† ìŠ¤íŠ¸ í‘œì‹œ ì˜¤ë¥˜:', error);
      // í† ìŠ¤íŠ¸ í‘œì‹œ ìì²´ê°€ ì‹¤íŒ¨í•˜ë©´ ê¸°ë³¸ alert ì‚¬ìš©
      alert(`${type.toUpperCase()}: ${message}`);
    }
  },

  /**
   * ì‘ë‹µ ëª¨ë‹¬ ì°½ í‘œì‹œ
   * 
   * LLM ì‘ë‹µì´ë‚˜ ìƒì„¸ ì •ë³´ë¥¼ ëª¨ë‹¬ ì°½ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
   * ì½˜í…ì¸ ë¥¼ ëª¨ë‹¬ ë‚´ë¶€ì— ë Œë”ë§í•˜ê³  í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
   * 
   * @param {string} content - ëª¨ë‹¬ì— í‘œì‹œí•  HTML ì½˜í…ì¸ 
   * @param {Object} options - ëª¨ë‹¬ í‘œì‹œ ì˜µì…˜ (í–¥í›„ í™•ì¥ìš©)
   * 
   * @example
   * UI.showModal('&lt;h3>AI ì‘ë‹µ&lt;/h3>&lt;p>ì²˜ë¦¬ ê²°ê³¼ì…ë‹ˆë‹¤.&lt;/p>');
   */
  showModal(content, options = {}) {
    try {
      console.log('[UI] ëª¨ë‹¬ í‘œì‹œ ì‹œì‘');
      
      const modal = this.safeGetElement('#response-modal');
      if (!modal) {
        console.error('[UI] ëª¨ë‹¬ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
        this.showToast('ëª¨ë‹¬ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
        return;
      }

      const modalContent = this.safeGetElement('#modal-content');
      if (!modalContent) {
        console.error('[UI] ëª¨ë‹¬ ì½˜í…ì¸  ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
        this.showToast('ëª¨ë‹¬ ì½˜í…ì¸ ë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
        return;
      }

      modalContent.innerHTML = content;
      modal.style.display = 'block';
      
      console.log('[UI] ëª¨ë‹¬ í‘œì‹œ ì™„ë£Œ');
      
    } catch (error) {
      console.error('[UI] ëª¨ë‹¬ í‘œì‹œ ì˜¤ë¥˜:', error);
      GlobalState.ErrorHandler.handleError(error, {
        context: 'ui_modal_display',
        userMessage: 'ì‘ë‹µ ì°½ì„ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
      });
    }
  },

  // ìºì‹œëœ ë°ì´í„°ë¡œ UIë¥¼ ì¦‰ì‹œ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
  updateUIWithCachedData() {
    try {
      if (!globalTicketData.summary) {
        console.log("âš ï¸ ìºì‹œëœ ë°ì´í„° ì—†ìŒ â†’ UI ì—…ë°ì´íŠ¸ ìŠ¤í‚µ");
        return;
      }

      console.log("ğŸ¯ ìºì‹œëœ ë°ì´í„°ë¡œ UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸ ì‹œì‘");

      // í‹°ì¼“ ê¸°ë³¸ ì •ë³´ ì—…ë°ì´íŠ¸ (ë°±ì—”ë“œ ì‘ë‹µì˜ ticket_data ì‚¬ìš©)
      if (globalTicketData.ticket_info) {
        this.updateTicketInfo(globalTicketData.ticket_info);
      }

      // ìš”ì•½ ì •ë³´ ì—…ë°ì´íŠ¸
      if (globalTicketData.summary) {
        const summaryContent = this.safeGetElement("#copilot-content");
        if (summaryContent) {
          summaryContent.innerHTML = this.formatSummaryForDisplay(
            globalTicketData.summary
          );
        }
      }

      // ìœ ì‚¬ í‹°ì¼“ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë¯¸ë¦¬ ì¤€ë¹„
      if (
        globalTicketData.similar_tickets &amp;&amp;
        globalTicketData.similar_tickets.length > 0
      ) {
        console.log(
          `âœ… ìœ ì‚¬ í‹°ì¼“ ${globalTicketData.similar_tickets.length}ê°œ ìºì‹œ ì¤€ë¹„ ì™„ë£Œ`
        );
      }

      // ì¶”ì²œ ì†”ë£¨ì…˜ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë¯¸ë¦¬ ì¤€ë¹„
      if (
        globalTicketData.recommended_solutions &amp;&amp;
        globalTicketData.recommended_solutions.length > 0
      ) {
        console.log(
          `âœ… ì¶”ì²œ ì†”ë£¨ì…˜ ${globalTicketData.recommended_solutions.length}ê°œ ìºì‹œ ì¤€ë¹„ ì™„ë£Œ`
        );
      }

      console.log("âœ… ìºì‹œëœ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸ ì™„ë£Œ");
    } catch (error) {
      console.error("âŒ ìºì‹œëœ ë°ì´í„°ë¡œ UI ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:", error);
    }
  },

  // í‹°ì¼“ ì •ë³´ UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜
  updateTicketInfo(ticket) {
    // ì œëª© ì—…ë°ì´íŠ¸
    const subjectElement = this.safeGetElement("#ticket-subject");
    if (subjectElement) {
      subjectElement.textContent = ticket.subject || "No subject available";
    }

    // ìƒíƒœ ì—…ë°ì´íŠ¸
    const statusElement = this.safeGetElement("#ticket-status");
    if (statusElement) {
      const statusText = getStatusText(ticket.status);
      statusElement.textContent = statusText;
      statusElement.className = `info-value status-${statusText.toLowerCase()}`;
    }

    // ìš°ì„ ìˆœìœ„ ì—…ë°ì´íŠ¸
    const priorityElement = this.safeGetElement("#ticket-priority");
    if (priorityElement) {
      const priorityText = getPriorityText(ticket.priority);
      priorityElement.textContent = priorityText;
      priorityElement.className = `info-value priority-${priorityText.toLowerCase()}`;
    }

    // íƒ€ì… ì—…ë°ì´íŠ¸
    const typeElement = this.safeGetElement("#ticket-type");
    if (typeElement) {
      typeElement.textContent = ticket.type || "Question";
    }

    console.log("âœ… í‹°ì¼“ ì •ë³´ UI ì—…ë°ì´íŠ¸ ì™„ë£Œ");
  },

  // ìœ ì‚¬ í‹°ì¼“ ë¦¬ìŠ¤íŠ¸ ë·° í‘œì‹œ
  showSimilarTicketsListView() {
    const listView = this.safeGetElement("#similar-tickets-list-view");
    const detailView = this.safeGetElement("#similar-tickets-detail-view");

    if (listView) listView.style.display = "block";
    if (detailView) detailView.style.display = "none";
  },

  // ìœ ì‚¬ í‹°ì¼“ ìƒì„¸ ë·° í‘œì‹œ
  showSimilarTicketDetailView(ticket) {
    const listView = this.safeGetElement("#similar-tickets-list-view");
    const detailView = this.safeGetElement("#similar-tickets-detail-view");
    const detailContent = this.safeGetElement(
      "#similar-ticket-detail-content"
    );
    const openTicketButton = this.safeGetElement("#open-ticket-link");

    if (listView) listView.style.display = "none";
    if (detailView) detailView.style.display = "block";

    // ë²„íŠ¼ì— í‹°ì¼“ ID ì €ì¥
    if (openTicketButton) {
      openTicketButton.dataset.ticketId = ticket.id;
    }

    if (detailContent) {
      detailContent.innerHTML = `
        &lt;div class="detail-content">
          &lt;div class="detail-meta">
            &lt;div class="d-flex justify-content-between align-items-start mb-2">
              &lt;h5 class="mb-0">#${ticket.id}&lt;/h5>
              &lt;span class="badge-custom ${getStatusClass(
                ticket.status
              )}">${getStatusText(ticket.status)}&lt;/span>
            &lt;/div>
            &lt;div class="row">
              &lt;div class="col-6">
                &lt;small class="text-muted">Priority:&lt;/small>
                &lt;div class="badge-custom ${getPriorityClass(
                  ticket.priority
                )}">${getPriorityText(ticket.priority)}&lt;/div>
              &lt;/div>
              &lt;div class="col-6">
                &lt;small class="text-muted">Type:&lt;/small>
                &lt;div>${ticket.type || "Question"}&lt;/div>
              &lt;/div>
            &lt;/div>
            ${
              ticket.created_at
                ? `
              &lt;div class="mt-2">
                &lt;small class="text-muted">Created:&lt;/small>
                &lt;div>${formatDate(ticket.created_at)}&lt;/div>
              &lt;/div>
            `
                : ""
            }
          &lt;/div>
          
          &lt;div class="detail-section">
            &lt;h6>Subject&lt;/h6>
            &lt;p>${ticket.subject || "No subject available"}&lt;/p>
          &lt;/div>
          
          ${
            ticket.description_text || ticket.description
              ? `
            &lt;div class="detail-section">
              &lt;h6>Description&lt;/h6>
              &lt;div class="description-content">
                ${formatDescription(
                  ticket.description_text || ticket.description
                )}
              &lt;/div>
            &lt;/div>
          `
              : ""
          }
          
          ${
            ticket.tags &amp;&amp; ticket.tags.length > 0
              ? `
            &lt;div class="detail-section">
              &lt;h6>Tags&lt;/h6>
              &lt;div>
                ${ticket.tags
                  .map(
                    (tag) => `&lt;span class="badge bg-secondary me-1">${tag}&lt;/span>`
                  )
                  .join("")}
              &lt;/div>
            &lt;/div>
          `
              : ""
          }
          
          ${
            ticket.fr_escalated
              ? `
            &lt;div class="detail-section">
              &lt;h6>Additional Info&lt;/h6>
              &lt;ul class="list-unstyled">
                &lt;li>&lt;strong>Escalated:&lt;/strong> Yes&lt;/li>
                ${
                  ticket.requester_id
                    ? `&lt;li>&lt;strong>Requester ID:&lt;/strong> ${ticket.requester_id}&lt;/li>`
                    : ""
                }
                ${
                  ticket.group_id
                    ? `&lt;li>&lt;strong>Group ID:&lt;/strong> ${ticket.group_id}&lt;/li>`
                    : ""
                }
              &lt;/ul>
            &lt;/div>
          `
              : ""
          }
        &lt;/div>
      `;
    }

    console.log("âœ… ìœ ì‚¬ í‹°ì¼“ ìƒì„¸ ì •ë³´ í‘œì‹œ ì™„ë£Œ");
  },

  // ìœ ì‚¬ í‹°ì¼“ ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ (ìƒˆë¡œìš´ ë¦¬ìŠ¤íŠ¸ í˜•íƒœ)
  displaySimilarTickets(similarTickets) {
    const resultsElement = this.safeGetElement("#similar-tickets-list");
    if (!resultsElement) return;

    if (similarTickets.length > 0) {
      resultsElement.innerHTML = `
        &lt;div class="similar-tickets-content">
          &lt;div class="mb-3">
            &lt;small class="text-muted">ë°œê²¬ëœ ìœ ì‚¬ í‹°ì¼“: ${similarTickets.length}ê°œ&lt;/small>
          &lt;/div>
          &lt;div id="tickets-container">&lt;/div>
        &lt;/div>
      `;

      const ticketsContainer = this.safeGetElement("tickets-container");

      // ê° ìœ ì‚¬ í‹°ì¼“ì„ ìƒˆë¡œìš´ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œìœ¼ë¡œ ë Œë”ë§
      similarTickets.forEach((similarTicket) => {
        const ticketItem = document.createElement("div");
        ticketItem.className = "list-item";

        // ìœ ì‚¬ë„ ì ìˆ˜ ê³„ì‚° (ì„ì‹œ)
        const similarityScore = similarTicket.score || Math.random() * 30 + 70;

        ticketItem.innerHTML = `
          &lt;div class="list-item-header">
            &lt;div class="list-item-title">${
              similarTicket.subject || "No subject"
            }&lt;/div>
            &lt;div class="d-flex align-items-center gap-2">
              &lt;span class="score-badge">${Math.round(similarityScore)}%&lt;/span>
              &lt;span class="badge-custom ${getStatusClass(
                similarTicket.status
              )}">${getStatusText(similarTicket.status)}&lt;/span>
            &lt;/div>
          &lt;/div>
          &lt;div class="list-item-meta">
            &lt;span>í‹°ì¼“ #${similarTicket.id}&lt;/span> â€¢ 
            &lt;span>ìš°ì„ ìˆœìœ„: ${getPriorityText(similarTicket.priority)}&lt;/span>
            ${
              similarTicket.created_at
                ? ` â€¢ &lt;span>${formatDate(similarTicket.created_at)}&lt;/span>`
                : ""
            }
          &lt;/div>
          ${
            similarTicket.issue || similarTicket.solution
              ? `
            &lt;div class="list-item-excerpt">
              ${
                similarTicket.issue
                  ? `&lt;div class="mb-2">ğŸ” &lt;strong>ë¬¸ì œ:&lt;/strong> ${truncateText(
                      similarTicket.issue,
                      100
                    )}&lt;/div>`
                  : ""
              }
              ${
                similarTicket.solution
                  ? `&lt;div>ğŸ’¡ &lt;strong>í•´ê²°ì±…:&lt;/strong> ${truncateText(
                      similarTicket.solution,
                      100
                    )}&lt;/div>`
                  : ""
              }
            &lt;/div>
          `
              : similarTicket.description_text || similarTicket.description
              ? `
            &lt;div class="list-item-excerpt">
              ${truncateText(
                similarTicket.description_text || similarTicket.description,
                150
              )}
            &lt;/div>
          `
              : ""
          }
          ${
            similarTicket.tags &amp;&amp; similarTicket.tags.length > 0
              ? `
            &lt;div class="mt-2">
              ${similarTicket.tags
                .slice(0, 3)
                .map(
                  (tag) =>
                    `&lt;span class="badge bg-light text-dark me-1">${tag}&lt;/span>`
                )
                .join("")}
              ${
                similarTicket.tags.length > 3
                  ? `&lt;span class="badge bg-light text-muted">+${
                      similarTicket.tags.length - 3
                    }&lt;/span>`
                  : ""
              }
            &lt;/div>
          `
              : ""
          }
        `;

        // í‹°ì¼“ ìƒì„¸ ë³´ê¸° í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
        ticketItem.addEventListener("click", function () {
          console.log("ğŸ“‹ ìœ ì‚¬ í‹°ì¼“ ìƒì„¸ ë³´ê¸°:", similarTicket.id);
          this.showSimilarTicketDetailView(similarTicket);
        });

        ticketsContainer.appendChild(ticketItem);
      });
    } else {
      // ë¹ˆ ë°°ì—´ì¼ ë•Œ ìºì‹œ ìƒíƒœë¥¼ ê³ ë ¤í•œ ì •ë³´ ì œê³µ
      const hasCachedData = globalTicketData.cached_ticket_id &amp;&amp; !isDataStale();
      const emptyMessage = hasCachedData
        ? "ì´ í‹°ì¼“ê³¼ ìœ ì‚¬í•œ ê³¼ê±° ì‚¬ë¡€ê°€ ì—†ê±°ë‚˜, ì•„ì§ ë°ì´í„°ê°€ ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
        : "ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì´ê±°ë‚˜ ì•„ì§ ë¶„ì„ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.&lt;br>í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.";

      resultsElement.innerHTML = `
        &lt;div class="empty-state">
          &lt;div class="empty-state-icon">ğŸ”&lt;/div>
          &lt;div class="empty-state-title">ìœ ì‚¬í•œ í‹°ì¼“ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤&lt;/div>
          &lt;div class="empty-state-description">
            ${emptyMessage}
          &lt;/div>
        &lt;/div>
      `;
    }

    console.log(`âœ… ìœ ì‚¬ í‹°ì¼“ ${similarTickets.length}ê°œ í‘œì‹œ ì™„ë£Œ`);
  },

  // ì¶”ì²œ ì†”ë£¨ì…˜ ë¦¬ìŠ¤íŠ¸ ë·° í‘œì‹œ
  showSuggestedSolutionsListView() {
    const listView = this.safeGetElement("#solutions-list-view");
    const detailView = this.safeGetElement("#solutions-detail-view");

    if (listView) listView.style.display = "block";
    if (detailView) detailView.style.display = "none";
  },

  // ì¶”ì²œ ì†”ë£¨ì…˜ ìƒì„¸ ë·° í‘œì‹œ
  showSuggestedSolutionDetailView(solution) {
    const listView = this.safeGetElement("#solutions-list-view");
    const detailView = this.safeGetElement("#solutions-detail-view");
    const detailContent = this.safeGetElement("#solution-detail-content");
    const useSolutionButton = this.safeGetElement("#use-solution");

    if (listView) listView.style.display = "none";
    if (detailView) detailView.style.display = "block";

    // ë²„íŠ¼ì— ì†”ë£¨ì…˜ ë°ì´í„° ì €ì¥
    if (useSolutionButton) {
      useSolutionButton.dataset.solution = JSON.stringify(solution);
    }

    if (detailContent) {
      detailContent.innerHTML = `
        &lt;div class="detail-content">
          &lt;div class="detail-meta">
            &lt;div class="d-flex justify-content-between align-items-start mb-2">
              &lt;h5 class="mb-0">${solution.title || "í•´ê²°ì±…"}&lt;/h5>
              ${
                solution.score
                  ? `&lt;span class="score-badge">${Math.round(
                      solution.score * 100
                    )}% ê´€ë ¨ë„&lt;/span>`
                  : ""
              }
            &lt;/div>
            &lt;div class="row">
              &lt;div class="col-6">
                &lt;small class="text-muted">ì¹´í…Œê³ ë¦¬:&lt;/small>
                &lt;div class="badge-custom bg-info">${
                  solution.category || "ì¼ë°˜"
                }&lt;/div>
              &lt;/div>
              &lt;div class="col-6">
                &lt;small class="text-muted">ìœ í˜•:&lt;/small>
                &lt;div>${solution.type || "Solution"}&lt;/div>
              &lt;/div>
            &lt;/div>
            ${
              solution.source
                ? `
              &lt;div class="mt-2">
                &lt;small class="text-muted">ì¶œì²˜:&lt;/small>
                &lt;div>${solution.source}&lt;/div>
              &lt;/div>
            `
                : ""
            }
          &lt;/div>
          
          ${
            solution.summary
              ? `
            &lt;div class="detail-section">
              &lt;h6>ìš”ì•½&lt;/h6>
              &lt;p>${solution.summary}&lt;/p>
            &lt;/div>
          `
              : ""
          }
          
          &lt;div class="detail-section">
            &lt;h6>í•´ê²°ì±… ë‚´ìš©&lt;/h6>
            &lt;div class="solution-content">
              ${formatSolutionContent(
                solution.content ||
                  solution.description ||
                  "ì†”ë£¨ì…˜ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤."
              )}
            &lt;/div>
          &lt;/div>
          
          ${
            solution.steps &amp;&amp; solution.steps.length > 0
              ? `
            &lt;div class="detail-section">
              &lt;h6>ë‹¨ê³„ë³„ í•´ê²° ê³¼ì •&lt;/h6>
              &lt;ol class="solution-steps">
                ${solution.steps.map((step) => `&lt;li>${step}&lt;/li>`).join("")}
              &lt;/ol>
            &lt;/div>
          `
              : ""
          }
          
          ${
            solution.tags &amp;&amp; solution.tags.length > 0
              ? `
            &lt;div class="detail-section">
              &lt;h6>ê´€ë ¨ íƒœê·¸&lt;/h6>
              &lt;div>
                ${solution.tags
                  .map(
                    (tag) => `&lt;span class="badge bg-secondary me-1">${tag}&lt;/span>`
                  )
                  .join("")}
              &lt;/div>
            &lt;/div>
          `
              : ""
          }
          
          ${
            solution.url
              ? `
            &lt;div class="detail-section">
              &lt;h6>ì¶”ê°€ ì •ë³´&lt;/h6>
              &lt;a href="${solution.url}" target="_blank" class="btn btn-outline-primary btn-sm">
                ì›ë³¸ ë¬¸ì„œ ë³´ê¸° &lt;i class="fas fa-external-link-alt">&lt;/i>
              &lt;/a>
            &lt;/div>
          `
              : ""
          }
        &lt;/div>
      `;
    }

    console.log("âœ… ì¶”ì²œ ì†”ë£¨ì…˜ ìƒì„¸ ì •ë³´ í‘œì‹œ ì™„ë£Œ");
  },

  // ì¶”ì²œ ì†”ë£¨ì…˜ í‘œì‹œ í•¨ìˆ˜ (ìƒˆë¡œìš´ ë¦¬ìŠ¤íŠ¸ í˜•íƒœ)
  displaySuggestedSolutions(solutions) {
    const resultsElement = this.safeGetElement("#suggested-solutions-list");
    if (!resultsElement) return;

    if (solutions.length > 0) {
      resultsElement.innerHTML = `
        &lt;div class="suggested-solutions-content">
          &lt;div class="mb-3">
            &lt;small class="text-muted">ì¶”ì²œ ì†”ë£¨ì…˜: ${solutions.length}ê°œ&lt;/small>
          &lt;/div>
          &lt;div id="solutions-container">&lt;/div>
        &lt;/div>
      `;

      const solutionsContainer = this.safeGetElement("solutions-container");

      // ê° ì†”ë£¨ì…˜ì„ ìƒˆë¡œìš´ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œìœ¼ë¡œ ë Œë”ë§
      solutions.forEach((solution, index) => {
        const solutionItem = document.createElement("div");
        solutionItem.className = "list-item";

        // ê´€ë ¨ë„ ì ìˆ˜ ê³„ì‚°
        const relevanceScore = solution.score
          ? Math.round(solution.score * 100)
          : Math.random() * 20 + 75;

        solutionItem.innerHTML = `
          &lt;div class="list-item-header">
            &lt;div class="list-item-title">${
              solution.title || `Solution ${index + 1}`
            }&lt;/div>
            &lt;div class="d-flex align-items-center gap-2">
              &lt;span class="score-badge">${relevanceScore}%&lt;/span>
              &lt;span class="badge-custom bg-info">${
                solution.category || "ì¼ë°˜"
              }&lt;/span>
            &lt;/div>
          &lt;/div>
          &lt;div class="list-item-meta">
            &lt;span>ìœ í˜•: ${solution.type || "Solution"}&lt;/span>
            ${solution.source ? ` â€¢ &lt;span>ì¶œì²˜: ${solution.source}&lt;/span>` : ""}
          &lt;/div>
          ${
            solution.content || solution.description
              ? `
            &lt;div class="list-item-excerpt">
              ${truncateText(solution.content || solution.description, 150)}
            &lt;/div>
          `
              : ""
          }
          ${
            solution.tags &amp;&amp; solution.tags.length > 0
              ? `
            &lt;div class="mt-2">
              ${solution.tags
                .slice(0, 3)
                .map(
                  (tag) =>
                    `&lt;span class="badge bg-light text-dark me-1">${tag}&lt;/span>`
                )
                .join("")}
              ${
                solution.tags.length > 3
                  ? `&lt;span class="badge bg-light text-muted">+${
                      solution.tags.length - 3
                    }&lt;/span>`
                  : ""
              }
            &lt;/div>
          `
              : ""
          }
        `;

        // ì†”ë£¨ì…˜ ìƒì„¸ ë³´ê¸° í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
        solutionItem.addEventListener("click", function () {
          console.log(
            "ğŸ’¡ ì¶”ì²œ ì†”ë£¨ì…˜ ìƒì„¸ ë³´ê¸°:",
            solution.title || `Solution ${index + 1}`
          );
          this.showSuggestedSolutionDetailView(solution);
        });

        solutionsContainer.appendChild(solutionItem);
      });
    } else {
      // ë¹ˆ ë°°ì—´ì¼ ë•Œ ìºì‹œ ìƒíƒœë¥¼ ê³ ë ¤í•œ ì •ë³´ ì œê³µ
      const hasCachedData = globalTicketData.cached_ticket_id &amp;&amp; !isDataStale();
      const emptyMessage = hasCachedData
        ? "í˜„ì¬ ì§€ì‹ë² ì´ìŠ¤ì—ì„œ ì´ ë¬¸ì œì™€ ê´€ë ¨ëœ ì†”ë£¨ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.&lt;br>ìƒˆë¡œìš´ ë¬¸ì„œê°€ ì¶”ê°€ë˜ê±°ë‚˜ ë” êµ¬ì²´ì ì¸ ì •ë³´ê°€ ìˆìœ¼ë©´ ê´€ë ¨ ì†”ë£¨ì…˜ì„ ì œì•ˆí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
        : "ì§€ì‹ë² ì´ìŠ¤ ë°ì´í„°ë¥¼ ë¡œë”© ì¤‘ì´ê±°ë‚˜ ì•„ì§ ë¶„ì„ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.&lt;br>í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.";

      resultsElement.innerHTML = `
        &lt;div class="empty-state">
          &lt;div class="empty-state-icon">ğŸ’¡&lt;/div>
          &lt;div class="empty-state-title">ì¶”ì²œí•  ì†”ë£¨ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤&lt;/div>
          &lt;div class="empty-state-description">
            ${emptyMessage}
          &lt;/div>
        &lt;/div>
      `;
    }

    console.log(`âœ… ì¶”ì²œ ì†”ë£¨ì…˜ ${solutions.length}ê°œ í‘œì‹œ ì™„ë£Œ`);
  },

  // í‹°ì¼“ ìš”ì•½ í‘œì‹œ í•¨ìˆ˜
  displayTicketSummary(summary) {
    const summarySection = this.safeGetElement("ticket-summary-section");
    if (!summarySection || !summary) return;

    summarySection.innerHTML = `
      &lt;div class="summary-section">
        &lt;h6>í‹°ì¼“ ìš”ì•½&lt;/h6>
        &lt;div class="summary-content">
          &lt;div class="mb-2">
            &lt;strong>ë¬¸ì œ:&lt;/strong> ${summary.problem || "ìš”ì•½ ì •ë³´ ì—†ìŒ"}
          &lt;/div>
          &lt;div class="mb-2">
            &lt;strong>ì›ì¸:&lt;/strong> ${summary.cause || "ë¶„ì„ ì¤‘"}
          &lt;/div>
          &lt;div class="mb-2">
            &lt;strong>í•´ê²°ë°©ì•ˆ:&lt;/strong> ${summary.solution || "ê²€í†  ì¤‘"}
          &lt;/div>
          &lt;div>
            &lt;strong>ì²˜ë¦¬ê²°ê³¼:&lt;/strong> ${summary.result || "ì§„í–‰ ì¤‘"}
          &lt;/div>
        &lt;/div>
      &lt;/div>
    `;

    console.log("âœ… í‹°ì¼“ ìš”ì•½ í‘œì‹œ ì™„ë£Œ");
  },

  // ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ê²°ê³¼ ì˜ì—­ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
  showErrorInResultsInResults(
    message,
    containerId = "similar-tickets-list"
  ) {
    try {
      const container = this.safeGetElement(containerId);
      if (container) {
        container.innerHTML = `
          &lt;div class="error-message alert alert-warning">
            &lt;i class="fas fa-exclamation-triangle">&lt;/i>
            ${message}
          &lt;/div>
        `;
      } else {
        console.warn(`âš ï¸ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${containerId}`);
      }
    } catch (error) {
      console.error("âŒ showErrorInResultsInResults ì˜¤ë¥˜", error);
    }
  },

  /**
   * ë¡œë”© ì¸ë””ì¼€ì´í„° í‘œì‹œ
   * 
   * ë°ì´í„° ë¡œë”© ì¤‘ì„ì„ ì‚¬ìš©ìì—ê²Œ ì‹œê°ì ìœ¼ë¡œ ì•Œë¦½ë‹ˆë‹¤.
   * ì§„í–‰ë¥ ê³¼ ì„¤ëª… ë©”ì‹œì§€ë¥¼ í•¨ê»˜ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
   * 
   * @param {string} message - ë¡œë”© ì¤‘ í‘œì‹œí•  ë©”ì‹œì§€
   * @param {number} progress - ì§„í–‰ë¥  (0-100, ì„ íƒì‚¬í•­)
   * @param {string} containerId - ë¡œë”©ì„ í‘œì‹œí•  ì»¨í…Œì´ë„ˆ ID (ì„ íƒì‚¬í•­)
   * 
   * @example
   * UI.showLoading('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...', 30);
   * UI.showLoading('AI ì‘ë‹µ ìƒì„± ì¤‘...', null, 'chat-container');
   */
  showLoading(message = 'ë¡œë”© ì¤‘...', progress = null, containerId = null) {
    try {
      console.log(`[UI] ë¡œë”© í‘œì‹œ: ${message} ${progress !== null ? `(${progress}%)` : ''}`);
      
      // ê¸°ì¡´ ë¡œë”© ì¸ë””ì¼€ì´í„° ì œê±°
      this.hideLoading(containerId);
      
      // ë¡œë”© ì¸ë””ì¼€ì´í„° ìƒì„±
      const loadingElement = document.createElement('div');
      loadingElement.className = 'loading-indicator';
      loadingElement.setAttribute('data-container', containerId || 'global');
      
      // ì§„í–‰ë¥  ë°”ê°€ ìˆëŠ” ê²½ìš°ì™€ ì—†ëŠ” ê²½ìš° êµ¬ë¶„
      const progressBarHTML = progress !== null ? `
        &lt;div class="progress-container">
          &lt;div class="progress-bar">
            &lt;div class="progress-fill" style="width: ${Math.max(0, Math.min(100, progress))}%">&lt;/div>
          &lt;/div>
          &lt;div class="progress-text">${Math.round(progress)}%&lt;/div>
        &lt;/div>
      ` : '';
      
      loadingElement.innerHTML = `
        &lt;div class="loading-content">
          &lt;div class="loading-spinner">
            &lt;div class="spinner-ring">&lt;/div>
            &lt;div class="spinner-ring">&lt;/div>
            &lt;div class="spinner-ring">&lt;/div>
          &lt;/div>
          &lt;div class="loading-message">${message}&lt;/div>
          ${progressBarHTML}
        &lt;/div>
      `;
      
      // ìŠ¤íƒ€ì¼ ì ìš©
      Object.assign(loadingElement.style, {
        position: 'absolute',
        top: '0',
        left: '0',
        right: '0',
        bottom: '0',
        background: 'rgba(255, 255, 255, 0.9)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        zIndex: '9999',
        fontSize: '14px',
        fontFamily: 'system-ui, -apple-system, sans-serif'
      });
      
      // CSS ìŠ¤íƒ€ì¼ì„ headì— ì¶”ê°€ (í•œ ë²ˆë§Œ)
      if (!document.querySelector('#loading-styles')) {
        const style = document.createElement('style');
        style.id = 'loading-styles';
        style.textContent = `
          .loading-content {
            text-align: center;
            max-width: 300px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
          }
          .loading-spinner {
            display: inline-block;
            position: relative;
            width: 40px;
            height: 40px;
            margin-bottom: 12px;
          }
          .spinner-ring {
            position: absolute;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2196f3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
          }
          .spinner-ring:nth-child(1) { width: 40px; height: 40px; }
          .spinner-ring:nth-child(2) { width: 30px; height: 30px; top: 5px; left: 5px; animation-delay: -0.3s; }
          .spinner-ring:nth-child(3) { width: 20px; height: 20px; top: 10px; left: 10px; animation-delay: -0.6s; }
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
          .loading-message {
            color: #333;
            font-weight: 500;
            margin-bottom: 12px;
          }
          .progress-container {
            margin-top: 16px;
          }
          .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
          }
          .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2196f3, #21cbf3);
            transition: width 0.3s ease;
          }
          .progress-text {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
          }
        `;
        document.head.appendChild(style);
      }
      
      // ì»¨í…Œì´ë„ˆ ì§€ì •
      const container = containerId ? this.safeGetElement(`#${containerId}`) : document.body;
      if (container) {
        // ì»¨í…Œì´ë„ˆê°€ relative positionì´ ì•„ë‹ˆë©´ ì„¤ì •
        if (window.getComputedStyle(container).position === 'static') {
          container.style.position = 'relative';
        }
        container.appendChild(loadingElement);
      } else {
        document.body.appendChild(loadingElement);
      }
      
      console.log('[UI] ë¡œë”© ì¸ë””ì¼€ì´í„° í‘œì‹œ ì™„ë£Œ');
      
    } catch (error) {
      console.error('[UI] ë¡œë”© ì¸ë””ì¼€ì´í„° í‘œì‹œ ì˜¤ë¥˜:', error);
    }
  },

  /**
   * ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸°
   * 
   * í‘œì‹œëœ ë¡œë”© ì¸ë””ì¼€ì´í„°ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
   * 
   * @param {string} containerId - íŠ¹ì • ì»¨í…Œì´ë„ˆì˜ ë¡œë”©ë§Œ ìˆ¨ê¸°ê¸° (ì„ íƒì‚¬í•­)
   * 
   * @example
   * UI.hideLoading(); // ëª¨ë“  ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸°
   * UI.hideLoading('chat-container'); // íŠ¹ì • ì»¨í…Œì´ë„ˆì˜ ë¡œë”©ë§Œ ìˆ¨ê¸°ê¸°
   */
  hideLoading(containerId = null) {
    try {
      const selector = containerId 
        ? `.loading-indicator[data-container="${containerId}"]`
        : '.loading-indicator';
        
      const loadingElements = document.querySelectorAll(selector);
      loadingElements.forEach(element => {
        element.remove();
      });
      
      if (loadingElements.length > 0) {
        console.log(`[UI] ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¹€ ì™„ë£Œ (${loadingElements.length}ê°œ)`);
      }
      
    } catch (error) {
      console.error('[UI] ë¡œë”© ì¸ë””ì¼€ì´í„° ìˆ¨ê¸°ê¸° ì˜¤ë¥˜:', error);
    }
  },

  /**
   * ë¡œë”© ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
   * 
   * í˜„ì¬ í‘œì‹œëœ ë¡œë”© ì¸ë””ì¼€ì´í„°ì˜ ì§„í–‰ë¥ ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
   * 
   * @param {number} progress - ìƒˆë¡œìš´ ì§„í–‰ë¥  (0-100)
   * @param {string} message - ì—…ë°ì´íŠ¸í•  ë©”ì‹œì§€ (ì„ íƒì‚¬í•­)
   * @param {string} containerId - ì—…ë°ì´íŠ¸í•  ì»¨í…Œì´ë„ˆ ID (ì„ íƒì‚¬í•­)
   * 
   * @example
   * UI.updateLoadingProgress(75, 'ê±°ì˜ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤...');
   */
  updateLoadingProgress(progress, message = null, containerId = null) {
    try {
      const selector = containerId 
        ? `.loading-indicator[data-container="${containerId}"]`
        : '.loading-indicator';
        
      const loadingElement = document.querySelector(selector);
      if (!loadingElement) {
        console.warn('[UI] ì—…ë°ì´íŠ¸í•  ë¡œë”© ì¸ë””ì¼€ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
        return;
      }
      
      // ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
      const progressFill = loadingElement.querySelector('.progress-fill');
      const progressText = loadingElement.querySelector('.progress-text');
      
      if (progressFill) {
        progressFill.style.width = `${Math.max(0, Math.min(100, progress))}%`;
      }
      
      if (progressText) {
        progressText.textContent = `${Math.round(progress)}%`;
      }
      
      // ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
      if (message) {
        const messageElement = loadingElement.querySelector('.loading-message');
        if (messageElement) {
          messageElement.textContent = message;
        }
      }
      
      console.log(`[UI] ë¡œë”© ì§„í–‰ë¥  ì—…ë°ì´íŠ¸: ${progress}%`);
      
    } catch (error) {
      console.error('[UI] ë¡œë”© ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
    }
  },

  /**
   * ê³µí†µ ëª¨ë‹¬ íŠ¸ë¦¬ê±° í•¨ìˆ˜ - ìºì‹œëœ ë°ì´í„°ë§Œ ì‚¬ìš©í•˜ì—¬ ì¦‰ì‹œ ì—´ê¸°
   * ë°±ì—”ë“œ í˜¸ì¶œ ì—†ì´ ëª¨ë‹¬ì„ ì¦‰ì‹œ ì—´ê³ , ìºì‹œëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ í‘œì‹œ
   */
  async showModal() {
    try {
      console.log("ğŸš€ ëª¨ë‹¬ ì—´ê¸° ì‹œì‘ (ë°±ì—”ë“œ í˜¸ì¶œ ì—†ìŒ)");

      // ì»¨í…ìŠ¤íŠ¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      const context = await client.instance.context();
      console.log("ğŸ“ ì»¨í…ìŠ¤íŠ¸ ì •ë³´:", context);

      const data = await client.data.get("ticket");
      const ticket = data.ticket;
      console.log("ğŸ“‹ í‹°ì¼“ ë°ì´í„° ê°€ì ¸ì˜´:", ticket.id);

      // ìºì‹œëœ ë°ì´í„° í™•ì¸ (ì„ íƒì  - ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ì–´ë„ ëª¨ë‹¬ ì—´ê¸°)
      const hasCachedData =
        globalTicketData.cached_ticket_id === ticket.id &amp;&amp;
        !isDataStale() &amp;&amp;
        globalTicketData.summary;

      if (hasCachedData) {
        console.log("âš¡ ìºì‹œëœ ë°ì´í„° ì‚¬ìš© ê°€ëŠ¥");
      } else {
        console.log("â„¹ï¸ ìºì‹œëœ ë°ì´í„° ì—†ìŒ - ë¹ˆ ìƒíƒœë¡œ ëª¨ë‹¬ ì—´ê¸°");
      }

      // í•­ìƒ ì¦‰ì‹œ ëª¨ë‹¬ ì—´ê¸° (ìºì‹œ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´)
      const modalConfig = {
        title: "Copilot Canvas",
        template: "index.html",
        data: {
          showAiTab: false,
          ticket,
          context: context,
        },
        noBackdrop: true,
        size: {
          width: "800px",
          height: "600px",
        },
      };

      console.log("ğŸ”§ ëª¨ë‹¬ ì„¤ì •:", modalConfig);
      await client.interface.trigger("showModal", modalConfig);
      console.log("âœ… ëª¨ë‹¬ ì¦‰ì‹œ ì—´ë¦¼ ì™„ë£Œ");
    } catch (error) {
      console.error("âŒ ëª¨ë‹¬ ì˜¤ë¥˜:", error);
      console.error("âŒ ëª¨ë‹¬ ì˜¤ë¥˜ ìŠ¤íƒ:", error.stack);

      // í´ë°±: ê°„ë‹¨í•œ ëª¨ë‹¬ë¡œ ì¬ì‹œë„
      try {
        console.log("ğŸ”„ í´ë°± ëª¨ë‹¬ ì‹œë„");
        await client.interface.trigger("showModal", {
          title: "Copilot Canvas",
          template: "index.html",
        });
        console.log("âœ… í´ë°± ëª¨ë‹¬ ì—´ë¦¼ ì™„ë£Œ");
      } catch (fallbackError) {
        console.error("âŒ í´ë°± ëª¨ë‹¬ë„ ì‹¤íŒ¨:", fallbackError);
      }
    }
  },

  /**
   * DOM ìš”ì†Œ ìºì‹± ë° ìµœì í™”ëœ ì ‘ê·¼
   */
  getDOMElement(selector, forceRefresh = false) {
      return window.PerformanceOptimizer.getDOMElement(selector, forceRefresh);
  },

  /**
   * ë°°ì¹˜ DOM ì—…ë°ì´íŠ¸ ì²˜ë¦¬
   * ì—¬ëŸ¬ DOM ì¡°ì‘ì„ í•œ ë²ˆì— ì²˜ë¦¬í•˜ì—¬ ë¦¬í”Œë¡œìš°/ë¦¬í˜ì¸íŠ¸ ìµœì†Œí™”
   */
  async batchDOMUpdates(updates) {
      return window.PerformanceOptimizer.batchDOMUpdates(updates);
  },

  /**
   * ê°€ìƒ ìŠ¤í¬ë¡¤ë§ ì§€ì› (ëŒ€ëŸ‰ ë°ì´í„° ë Œë”ë§ ìµœì í™”)
   */
  createVirtualList(container, items, renderItem, itemHeight = 50) {
      const virtualList = {
          container: container,
          items: items,
          renderItem: renderItem,
          itemHeight: itemHeight,
          visibleStart: 0,
          visibleEnd: 0,
          scrollTop: 0,
          containerHeight: 0,
          totalHeight: items.length * itemHeight,
          
          init() {
              this.containerHeight = container.clientHeight;
              this.calculateVisibleRange();
              this.render();
              this.setupScrollListener();
          },
          
          calculateVisibleRange() {
              const buffer = 5; // ë²„í¼ ì•„ì´í…œ ìˆ˜
              this.visibleStart = Math.max(0, Math.floor(this.scrollTop / this.itemHeight) - buffer);
              this.visibleEnd = Math.min(
                  this.items.length,
                  Math.ceil((this.scrollTop + this.containerHeight) / this.itemHeight) + buffer
              );
          },
          
          render() {
              // ê¸°ì¡´ ë‚´ìš© ì •ë¦¬
              container.innerHTML = '';
              
              // ì „ì²´ ë†’ì´ë¥¼ ìœ„í•œ ìŠ¤í˜ì´ì„œ
              const spacer = document.createElement('div');
              spacer.style.height = `${this.totalHeight}px`;
              spacer.style.position = 'relative';
              container.appendChild(spacer);
              
              // ë³´ì´ëŠ” ì•„ì´í…œë“¤ë§Œ ë Œë”ë§
              for (let i = this.visibleStart; i &lt; this.visibleEnd; i++) {
                  const item = this.items[i];
                  const element = this.renderItem(item, i);
                  element.style.position = 'absolute';
                  element.style.top = `${i * this.itemHeight}px`;
                  element.style.width = '100%';
                  element.style.height = `${this.itemHeight}px`;
                  spacer.appendChild(element);
              }
          },
          
          setupScrollListener() {
              const throttledScroll = window.PerformanceOptimizer.throttle(() => {
                  const newScrollTop = container.scrollTop;
                  if (Math.abs(newScrollTop - this.scrollTop) > this.itemHeight) {
                      this.scrollTop = newScrollTop;
                      this.calculateVisibleRange();
                      this.render();
                  }
              }, 16); // 60fps
              
              container.addEventListener('scroll', throttledScroll);
          },
          
          updateItems(newItems) {
              this.items = newItems;
              this.totalHeight = newItems.length * this.itemHeight;
              this.calculateVisibleRange();
              this.render();
          }
      };
      
      virtualList.init();
      return virtualList;
  },

  /**
   * ë ˆì´ì§€ ë¡œë”© ì´ë¯¸ì§€ ì§€ì›
   */
  setupLazyImages(container = document) {
      const imageObserver = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
              if (entry.isIntersecting) {
                  const img = entry.target;
                  if (img.dataset.src) {
                      img.src = img.dataset.src;
                      img.removeAttribute('data-src');
                      imageObserver.unobserve(img);
                  }
              }
          });
      });
      
      container.querySelectorAll('img[data-src]').forEach(img => {
          imageObserver.observe(img);
      });
      
      return imageObserver;
  },

  /**
   * ìŠ¤ë§ˆíŠ¸ ê²€ìƒ‰ ë° í•„í„°ë§ (ë””ë°”ìš´ìŠ¤ ì ìš©)
   */
  setupSmartSearch(inputElement, searchCallback, options = {}) {
      const {
          debounceMs = 300,
          minLength = 2,
          placeholder = 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”...'
      } = options;
      
      inputElement.placeholder = placeholder;
      
      const debouncedSearch = window.PerformanceOptimizer.debounce(async (query) => {
          if (query.length >= minLength) {
              try {
                  this.showLoading('ê²€ìƒ‰ ì¤‘...', 'search-loading');
                  await searchCallback(query);
              } catch (error) {
                  window.ErrorHandler.handleError(error, {
                      context: 'smart_search',
                      userMessage: 'ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'
                  });
              } finally {
                  this.hideLoading('search-loading');
              }
          } else if (query.length === 0) {
              searchCallback(''); // ì „ì²´ ëª©ë¡ í‘œì‹œ
          }
      }, debounceMs);
      
      inputElement.addEventListener('input', (e) => {
          debouncedSearch(e.target.value.trim());
      });
  },

  /**
   * ìµœì í™”ëœ í‹°ì¼“ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
   */
  async renderOptimizedTicketList(tickets, container) {
      if (!tickets || tickets.length === 0) {
          container.innerHTML = '&lt;div class="no-data">í‘œì‹œí•  í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤.&lt;/div>';
          return;
      }
      
      // ëŒ€ëŸ‰ ë°ì´í„°ì˜ ê²½ìš° ê°€ìƒ ìŠ¤í¬ë¡¤ë§ ì‚¬ìš©
      if (tickets.length > 100) {
          return this.createVirtualList(container, tickets, (ticket, index) => {
              const element = document.createElement('div');
              element.className = 'ticket-item';
              element.innerHTML = this.generateTicketHTML(ticket);
              return element;
          }, 80);
      }
      
      // ì¼ë°˜ì ì¸ ê²½ìš° ë°°ì¹˜ ë Œë”ë§
      const updates = tickets.map(ticket => ({
          type: 'create',
          tag: 'div',
          properties: {
              className: 'ticket-item',
              innerHTML: this.generateTicketHTML(ticket)
          },
          parent: container
      }));
      
      // ê¸°ì¡´ ë‚´ìš© ì •ë¦¬
      container.innerHTML = '';
      
      // ë°°ì¹˜ ì—…ë°ì´íŠ¸ ì‹¤í–‰
      await this.batchDOMUpdates(updates);
  },

  /**
   * ìµœì í™”ëœ ì†”ë£¨ì…˜ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
   */
  async renderOptimizedSolutionList(solutions, container) {
      if (!solutions || solutions.length === 0) {
          container.innerHTML = '&lt;div class="no-data">í‘œì‹œí•  ì†”ë£¨ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.&lt;/div>';
          return;
      }
      
      // ë°°ì¹˜ ë Œë”ë§ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”
      const updates = solutions.map(solution => ({
          type: 'create',
          tag: 'div',
          properties: {
              className: 'solution-item',
              innerHTML: this.generateSolutionHTML(solution)
          },
          parent: container
      }));
      
      container.innerHTML = '';
      await this.batchDOMUpdates(updates);
  },

  // UI ëª¨ë“ˆ export - ì£¼ìš” í•¨ìˆ˜ë“¤ì„ UI ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ë…¸ì¶œ
  UI: {
    updateUIWithCachedData: this.updateUIWithCachedData,
    updateTicketInfo: this.updateTicketInfo,
    displayTicketSummary: this.displayTicketSummary,
    displaySimilarTickets: this.displaySimilarTickets,
    displaySuggestedSolutions: this.displaySuggestedSolutions,
    showSimilarTicketsListView: this.showSimilarTicketsListView,
    showSimilarTicketsDetailView: this.showSimilarTicketsDetailView,
    showSuggestedSolutionsListView: this.showSuggestedSolutionsListView,
    showSuggestedSolutionsDetailView: this.showSuggestedSolutionsDetailView,
    loadTicketDetails: loadTicketDetails,
    showModal: this.showModal,
    formatSummaryForDisplay: this.formatSummaryForDisplay,
    formatSolutionContent: this.formatSolutionContent,
  },

  // ì˜ì¡´ì„± í™•ì¸ í•¨ìˆ˜ - ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ UI ëª¨ë“ˆ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ ì²´í¬
  isAvailable: function() {
    return typeof GlobalState !== 'undefined' &amp;&amp; typeof Utils !== 'undefined';
  },
};

console.log('ğŸ¨ UI ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ - 12ê°œ í•¨ìˆ˜ exportë¨');

// ëª¨ë“ˆ ì˜ì¡´ì„± ì‹œìŠ¤í…œì— ë“±ë¡
if (typeof ModuleDependencyManager !== 'undefined') {
  ModuleDependencyManager.registerModule('ui', Object.keys(UI).length);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="global.html#API">API</a></li><li><a href="Data.html">Data</a></li><li><a href="DebugTools.html">DebugTools</a></li><li><a href="Events.html">Events</a></li><li><a href="GlobalState.html">GlobalState</a></li><li><a href="ModuleDependencyManager.html">ModuleDependencyManager</a></li><li><a href="UI.html">UI</a></li><li><a href="Utils.html">Utils</a></li></ul><h3>Global</h3><ul><li><a href="global.html#callBackendAPI">callBackendAPI</a></li><li><a href="global.html#client">client</a></li><li><a href="global.html#debugGlobalState">debugGlobalState</a></li><li><a href="global.html#extractCompanyIdFromDomain">extractCompanyIdFromDomain</a></li><li><a href="global.html#getFreshdeskConfigFromIparams">getFreshdeskConfigFromIparams</a></li><li><a href="global.html#getGlobalLoading">getGlobalLoading</a></li><li><a href="global.html#getGlobalTicketData">getGlobalTicketData</a></li><li><a href="global.html#getInitialized">getInitialized</a></li><li><a href="global.html#globalTicketData">globalTicketData</a></li><li><a href="global.html#initializeApp">initializeApp</a></li><li><a href="global.html#isGlobalDataValid">isGlobalDataValid</a></li><li><a href="global.html#isInitialized">isInitialized</a></li><li><a href="global.html#loadInitialDataFromBackend">loadInitialDataFromBackend</a></li><li><a href="global.html#loadSimilarTicketsFromBackend">loadSimilarTicketsFromBackend</a></li><li><a href="global.html#resetGlobalTicketCache">resetGlobalTicketCache</a></li><li><a href="global.html#setGlobalLoading">setGlobalLoading</a></li><li><a href="global.html#setInitialized">setInitialized</a></li><li><a href="global.html#showErrorInResults">showErrorInResults</a></li><li><a href="global.html#showLoadingInResults">showLoadingInResults</a></li><li><a href="global.html#smartDomainParsingFrontend">smartDomainParsingFrontend</a></li><li><a href="global.html#updateGlobalTicketData">updateGlobalTicketData</a></li><li><a href="global.html#validateAndInitializeApp">validateAndInitializeApp</a></li><li><a href="global.html#validateGlobalState">validateGlobalState</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Mon Jun 16 2025 23:16:45 GMT+0900 (ëŒ€í•œë¯¼êµ­ í‘œì¤€ì‹œ)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
