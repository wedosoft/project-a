# 프로젝트 규칙 및 가이드라인

## 프로젝트 컨텍스트

이 프로젝트는 Freshdesk Custom App(Prompt Canvas)을 위한 백엔드 서비스입니다.
RAG(Retrieval-Augmented Generation) 기술을 활용하여 Freshdesk 티켓과 지식베이스를 기반으로 AI 기반 응답 생성 기능을 제공합니다.
현재 백엔드는 FastAPI와 ChromaDB(VectorDB)로 구축되어 있으며, 프론트엔드는 Freshdesk FDK + Block 에디터(Prompt Canvas)를 사용하여 구현될 예정입니다.
모든 코드는 모듈식 아키텍처와 간단한 MVP 원칙을 따라야 합니다.

## 아키텍처 원칙

1. **모듈화된 구조**
   - 기능별로 파일 분리 (fetcher / embedder / retriever)
   - 각 모듈은 명확한 단일 책임을 가짐
   - 모듈 간 의존성 최소화

2. **간단한 MVP 원칙**
   - 필요한 기능만 구현
   - 복잡성보다 단순성 우선
   - 작동하는 코드를 빠르게 배포하고 점진적으로 개선

## 코딩 표준

1. **코드 스타일**
   - Python PEP 8 코딩 표준 준수
   - 일관된 들여쓰기 및 코드 포맷팅 유지
   - 주석은 한글로 작성

2. **비동기 프로그래밍**
   - FastAPI에서 async/await 패턴 사용
   - 외부 API 호출 시 비동기 클라이언트 활용

3. **타입 힌트 및 문서화**
   - 모든 함수와 메서드에 타입 힌트 포함
   - 모든 모듈, 클래스, 함수에 docstring 추가
   - 복잡한 로직에 주석 추가

4. **보안 관행**
   - 모든 민감한 키는 환경 변수로 관리
   - API 키 등은 코드에 직접 포함하지 않음
   - 사용자 입력 검증 철저히 수행

## 기능 구현 가이드라인

1. **Freshdesk 데이터 가져오기**
   - Freshdesk API를 통해 티켓 및 지식베이스 문서 가져오기
   - 데이터 전처리 및 구조화

2. **문서 임베딩**
   - 문서 텍스트를 벡터로 변환
   - OpenAI 또는 다른 임베딩 모델 활용

3. **데이터 저장 및 검색**
   - ChromaDB에 임베딩 벡터와 원본 문서 저장
   - 효율적인 검색을 위한 인덱싱

4. **AI 응답 생성**
   - 검색된 관련 문서를 기반으로 LLM 프롬프트 구성
   - Anthropic Claude 또는 다른 LLM 활용

## API 엔드포인트 설계

1. **/query**
   - 사용자 질문을 받아 관련 문서 검색 및 AI 응답 생성
   - 응답에 참고 문서와 생성된 답변 포함

2. 추가 필요한 엔드포인트 (향후 구현)
   - 데이터 동기화 및 관리 엔드포인트
   - 모니터링 및 성능 분석 엔드포인트

## 테스트 및 품질 관리

1. **단위 테스트**
   - 각 모듈의 핵심 기능에 대한 테스트 작성
   - pytest 프레임워크 활용

2. **통합 테스트**
   - API 엔드포인트에 대한 엔드투엔드 테스트
   - 실제 환경과 유사한 조건에서 테스트

3. **코드 리뷰**
   - 모든 변경사항에 대한 코드 리뷰 수행
   - 코드 품질 및 규칙 준수 확인

## 배포 및 운영

1. **Docker 컨테이너화**
   - docker-compose를 통한 로컬 개발 환경 구성
   - 프로덕션 환경을 위한 최적화된 Dockerfile

2. **성능 모니터링**
   - API 요청 응답 시간 모니터링
   - 리소스 사용량 추적
   - 에러 로깅 및 분석

## 지속적인 개선

1. **피드백 수집**
   - 사용자 피드백을 바탕으로 기능 개선
   - 성능 지표 분석을 통한 최적화

2. **기술 스택 업데이트**
   - 새로운 LLM 모델 및 임베딩 기술 적용
   - 보안 및 성능 업데이트 정기적 적용